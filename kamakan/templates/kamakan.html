<!DOCTYPE html>
<html>

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PPRZ08QFDN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-PPRZ08QFDN');
  </script>

  <script src="https://cdn.rawgit.com/lodash/lodash/3.0.1/lodash.min.js"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>kamakan</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/handsontable/0.24.3/handsontable.full.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handsontable/0.24.3/handsontable.full.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.4.js"></script>
  <script src="finance.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.js"></script>

  <script src="jquery.qrcode.min.js"></script>

  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
<!--アイコン-->
<link rel="apple-touch-icon" sizes="57x57" href="icon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="icon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="icon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="icon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="icon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="icon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="icon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="icon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="icon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="icon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="icon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="icon/favicon-16x16.png">
<link rel="manifest" href="icon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="icon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
</head>



<script type="text/javascript">

  $(function () {
    $('[data-toggle="tooltip"]').tooltip()
  })
</script>
<style>
  /*googlemap*/
  .form-control::placeholder {
    color: #cccccc;
  }

  .loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 2;
  }

  #map_container {
    clear: both;
    width: 400px;
    padding: 4px;
  }

  #map_canvas {
    /* 高さ（と幅）を指定しないと地図は表示されない */
    width: 385px;
    height: 385px;
  }

  #url,
  #zoom {
    display: none;
    /* 非表示 */
  }

  /* 情報ウィンドウ（マーカーをクリックすると表示される領域）内 */
  #map_content {
    width: 385px;
    height: 385px;
  }

  /*セル部分の文字サイズ*/
  .handsontable th,
  .handsontable td {
    padding: 0px;
    font-size: 6px;
    text-align: right;
  }

  .snackbar {
    display: inline-block;
    position: fixed;
    background: #323232;
    color: #f1f1f1;
    min-height: 50px;
    min-width: 290px;
    padding: 16px 24px 12px;
    box-sizing: border-box;
    box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);
    border-radius: 2px;
    bottom: 1rem;
    left: 50%;
    font-size: 90%;
    -webkit-transition: visibility 0.3s, -webkit-transform 0.3s;
    transition: visibility 0.3s, -webkit-transform 0.3s;
    transition: visibility 0.3s, transform 0.3s;
    transition: visibility 0.3s, transform 0.3s, -webkit-transform 0.3s;
    -webkit-transform: translate(-50%, 100px);
    transform: translate(-50%, 100px);
    visibility: hidden;
    will-change: transform;
    z-index: 200000;
  }

  .snackbar--visible {
    visibility: visible;
    -webkit-transform: translate(-50%, 0);
    transform: translate(-50%, 0);
  }

  @import url(https://fonts.googleapis.com/css?family=Open+Sans:400,300);
</style>
</head>

<body>
  <!-- Modal テスト用-->
  <div id="print-button-wrap" class="position-fixed text-right invisible"
    style="z-index: 200; bottom:20px; right: 10px;">
    <button type="button" class="btn btn-primary" id="print-button">
      PDF出力
    </button>
  </div>
  <div class="modal" tabindex="-1" role="dialog" id="myModal">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">PDF出力</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch0" checked="">
            <label class="custom-control-label" for="customSwitch0">表示グラフ</label>
          </div>
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch1">
            <label class="custom-control-label" for="customSwitch1">CFツリー（GPI・EGI・OPEX・NOI・ADS・CF）</label>
          </div>
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch2">
            <label class="custom-control-label" for="customSwitch2">デッドクロス（ローン元金・減価償却費・ATCF）</label>
          </div>
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch3">
            <label class="custom-control-label" for="customSwitch3">税引後CF（ATCF・累積ATCF）</label>
          </div>
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch4">
            <label class="custom-control-label" for="customSwitch4">資金回収期間（累積ATCF・投下自己資金）</label>
          </div>
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch5">
            <label class="custom-control-label" for="customSwitch5">売却の検討（売却想定価格・ローン残債・物件購入価格・売却時手取金額（税引後））</label>
          </div>
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch6">
            <label class="custom-control-label" for="customSwitch6">相続税納税資金の準備（相続税額・現金資産・相続税納税後剰余額）</label>
          </div>
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch7">
            <label class="custom-control-label" for="customSwitch7">IRRとNPV(IRR・NPV）</label>
          </div>
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch8">
            <label class="custom-control-label" for="customSwitch8">相続税圧縮額勘案NPV（相続圧縮勘案NPV・NPV)</label>
          </div>
        </div>
        <div class="modal-footer">
          <form>
            <div class="form-row align-items-center">
              <div class="col-sm-3 my-1">
                <label class="sr-only" for="inlineFormInputName">User</label>
                <input type="text" class="form-control" id="inlineFormInputName" placeholder="user">
              </div>
              <div class="col-sm-4 my-1">
                <label class="sr-only" for="inlineFormInputGroupUsername">domain</label>
                <div class="input-group">
                  <div class="input-group-prepend">
                    <div class="input-group-text">@</div>
                  </div>
                  <input type="text" class="form-control" id="inlineFormInputGroupUsername" placeholder="domain">
                </div>
              </div>
               <button type="submit" class="btn btn-info" onclick="window.open('https://kkantei.com/%e5%80%8b%e4%ba%ba%e6%83%85%e5%a0%b1%e3%81%ae%e5%8f%96%e3%82%8a%e6%89%b1%e3%81%84%e3%81%ab%e3%81%a4%e3%81%84%e3%81%a6/', 'kj','width=1280,height=720,noopener'); return false;"
>使用規約をお読みください</button>
             <div class="col-sm-10 my-1">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="check-mailsend">
                  <label class="form-check-label" for="check-mailsend" style="font-size: 1em;">
                    使用規約を確認しました
                  </label>
                </div>
              </div>
               <div class="col-sm-10 my-1">
                <button type="submit" class="btn btn-primary" id="pdf-exchange" disabled>送信</button>
              </div>
               <div class="col-sm-10 my-1">
                <div id="pdf-st"></div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal テスト用 End -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light"> <a class="navbar-brand" href="https://kkantei.com"
      target="_blank">kamakan!</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent1"
      aria-controls="navbarSupportedContent1" aria-expanded="false" aria-label="Toggle navigation"> <span
        class="navbar-toggler-icon"></span> </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent1">


      <input class="btn btn-outline-primary my-2 my-sm-0" type="file" id="file" text="既存物件情報の読み込み">

    </div>
    <a class="btn btn-outline-success" href="https://kkantei.com/contact/" target="_blank">相続無料個別相談</a>


  </nav>
  <img src="images/widelogo.png" class="w-50 loading border shadow"></div>
  <div class="jumbotron">

    <div class="embed-responsive embed-responsive-16by9">

      <div id="Movie"></div>

    </div>
  </div>
  <div class="row">
    <div class="col-lg-6">
      <h2 class="input-group input-group-sm mb-3 my-2 my-lg-0" id="t_name_property">
        <div class="input-group-prepend"> <span class="input-group-text">物件名称　　　</span> </div>
        <input type="text" class="form-control h2" id="name_property">
      </h2>
    </div>
    <div class="col-lg-3">
      <div class="input-group input-group-sm mb-3"　id="t_price_property">
        <div class="input-group-prepend"> <span class="input-group-text">物件価格　　　</span> </div>
        <input type="tel" class="form-control text-right" id="price_property" value="10000">
        <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
      </div>
    </div>
    <div class="col-lg-3">
      <div class="input-group input-group-sm mb-3">
        <div class="input-group-prepend"> <span class="input-group-text">建築形態</span> </div>
          <select type="text" class="form-control address" id="build_style">
            　　　　 <option value="1">土地建物新規購入</option>
                    <option value="2">所有地に新築</option>
                    <option value="3">所有地に建替</option>
          </select>
        </div>
    </div>
    <div class="container-fluid">
      <ul id="clothingnav1" class="nav nav-tabs" role="tablist">
        <li class="nav-item "> <a class="nav-link active" href="#home1" id="hometab1" role="tab" data-toggle="tab"
            aria-controls="home" aria-expanded="true">データ入力</a> </li>
        <li class="nav-item"> <a class="nav-link" href="#paneTwo1" role="tab" id="hatstab1" data-toggle="tab"
            aria-controls="hats">分析元データ</a> </li>
        <li class="nav-item"> <a class="nav-link" href="#paneTwo2" role="tab" id="hatstab2" data-toggle="tab"
            aria-controls="hats">分析結果</a> </li>
        </li>
      </ul>

      <!-- Content Panel -->
      <div id="clothingnavcontent1" class="tab-content">
        <div role="tabpanel" class="tab-pane fade show active" id="home1" aria-labelledby="hometab1">
          <div class="row">
            <div class="col-lg-3 border rounded">
              <form>
                <div class="form-group">
                  　　　　 <div class="card-header mb-5 text-center w-100 w-100">物件所在地</div>
                  <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend"> <span class="input-group-text">都道府県　</span> </div>
                    <select type="text" class="form-control address" id="prefectures">
                      　　　　 <option value="1">北海道</option>
                      <option value="2">青森県</option>
                      <option value="3">岩手県</option>
                      <option value="4">宮城県</option>
                      <option value="5">秋田県</option>
                      <option value="6">山形県</option>
                      <option value="7">福島県</option>
                      <option value="8">茨城県</option>
                      <option value="9">栃木県</option>
                      <option value="10">群馬県</option>
                      <option value="11">埼玉県</option>
                      <option value="12">千葉県</option>
                      <option value="13">東京都</option>
                      <option value="14" selected>神奈川県</option>
                      <option value="15">新潟県</option>
                      <option value="16">富山県</option>
                      <option value="17">石川県</option>
                      <option value="18">福井県</option>
                      <option value="19">山梨県</option>
                      <option value="20">長野県</option>
                      <option value="21">岐阜県</option>
                      <option value="22">静岡県</option>
                      <option value="23">愛知県</option>
                      <option value="24">三重県</option>
                      <option value="25">滋賀県</option>
                      <option value="26">京都府</option>
                      <option value="27">大阪府</option>
                      <option value="28">兵庫県</option>
                      <option value="29">奈良県</option>
                      <option value="30">和歌山県</option>
                      <option value="31">鳥取県</option>
                      <option value="32">島根県</option>
                      <option value="33">岡山県</option>
                      <option value="34">広島県</option>
                      <option value="35">山口県</option>
                      <option value="36">徳島県</option>
                      <option value="37">香川県</option>
                      <option value="38">愛媛県</option>
                      <option value="39">高知県</option>
                      <option value="40">福岡県</option>
                      <option value="41">佐賀県</option>
                      <option value="42">長崎県</option>
                      <option value="43">熊本県</option>
                      <option value="44">大分県</option>
                      <option value="45">宮崎県</option>
                      <option value="46">鹿児島県</option>
                      <option value="47">沖縄県</option>
                    </select>
                  </div>
                  　　　　 <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend"> <span class="input-group-text">以下住所　</span> </div>
                    <input type="text" class="form-control address" id="address_property" value="鎌倉市大船２−１９−３５">
                  </div>
                  <a id="chikamap" class="btn-default btn-sm" a href="https://www.rosenka.nta.go.jp" target="_blank"
                    rel="noopener" tip="aaa">国税庁路線価</a>
                  <a id="chikamap" class="btn-default btn-sm" a href="https://www.chikamap.jp/chikamap/Portal"
                    target="_blank" rel="noopener">地価マップ</a>
                  <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend"> <span class="input-group-text">路線価URL</span> </div>
                    <input type="url" class="form-control address" id="url_rosenka" disabled=true>
                    <div class="input-group-prepend"> <button class="input-group-text" id="button_url_rosenka"></button>
                    </div>
                  </div>
                  <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend"> <span class="input-group-text">路線価　　</span> </div>
                    <input type="tel" class="form-control auto_propertytaxland text-right" type="tel" id="road_price"
                      value="200" min="1">
                    <div class="input-group-prepend"> <span class="input-group-text">　千円　</span> </div>
                  </div>
                  　 <div class="input-group input-group-sm mb-3">
                    <div class="input-group-prepend"> <span class="input-group-text">借地権割合</span> </div>
                    <select type="tel" class="form-control address" id="leasehold">
                      <option value="90">A(90％)</option>
                      <option value="80">B(80％)</option>
                      <option value="70" selected>C(70％)</option>
                      　　　　<option value="60">D(60％)</option>
                      　　　　<option value="50">E(50％)</option>
                      <option value="40">F(40％)</option>
                      <option value="30">G(30％)</option>
                      <option value="0">自用地(0%)</option>
                    </select>
                  </div>
              </form>
            </div>
          </div>
          <div class="col-lg-3 border rounded">
            <form>
              <div class="card-header mb-2 mt-4 text-center w-100">地図</div>
              <div class="embed-responsive embed-responsive-6by9">
                <div id="map_container">
                  　 <div id="map_canvas"></div>
                  　 </div>
              </div>
            </form>
          </div>
          <div class="col-lg-3 border rounded">
            <form>
              <div class="form-group">
                <div class="card-header mb-5 mt-4 text-center w-100">物件データ</div>
                <div class="input-group input-group-sm mb-3">
                  <div class="input-group-prepend"> <span class="input-group-text">土地面積　</span> </div>
                  <input type="tel" class="form-control auto_propertytaxland special_aa text-right" id="area_land"
                    placeholder="100" min="0">
                  <div class="input-group-prepend"> <span class="input-group-text">㎡　</span> </div>
                </div>
                <div class="input-group input-group-sm mb-3">
                  <div class="input-group-prepend"> <span class="input-group-text">建物面積　</span> </div>
                  <input type="tel" class="form-control auto_propertytaxbuilding text-right" id="area_building"
                    placeholder="100" min="0">
                  <div class="input-group-prepend"> <span class="input-group-text">㎡　</span> </div>
                </div>
                <div class="input-group input-group-sm mb-3">
                  <div class="input-group-prepend"> <span class="input-group-text">建築年　　</span> </div>
                  <select type="tel" class="form-control auto_propertytaxbuilding"
                    id="initial_years_since_construction">
                    <option value="0">令和4年(2022年)新築</option>
                    <option value="1">令和3年(2021年)築1年</option>
                    <option value="2">令和2年(2020年)築2年</option>
                    <option value="3">令和1年(2019年)築3年</option>
                    <option value="4">平成30年(2018年)築4年</option>
                    <option value="5">平成29年(2017年)築5年</option>
                    <option value="6">平成28年(2016年)築6年</option>
                    <option value="7">平成27年(2015年)築7年</option>
                    <option value="8">平成26年(2014年)築8年</option>
                    <option value="9">平成25年(2013年)築9年</option>
                    <option value="10">平成24年(2012年)築10年</option>
                    <option value="11">平成23年(2011年)築11年</option>
                    <option value="12">平成22年(2010年)築12年</option>
                    <option value="13">平成21年(2009年)築13年</option>
                    <option value="14">平成20年(2008年)築14年</option>
                    <option value="15">平成19年(2007年)築15年</option>
                    <option value="16">平成18年(2006年)築16年</option>
                    <option value="17">平成17年(2005年)築17年</option>
                    <option value="18">平成16年(2004年)築18年</option>
                    <option value="19">平成15年(2003年)築19年</option>
                    <option value="20">平成14年(2002年)築20年</option>
                    <option value="21">平成13年(2001年)築21年</option>
                    <option value="22">平成12年(2000年)築22年</option>
                    <option value="23">平成11年(1999年)築23年</option>
                    <option value="24">平成10年(1998年)築24年</option>
                    <option value="25">平成9年(1997年)築25年</option>
                    <option value="26">平成8年(1996年)築26年</option>
                    <option value="27">平成7年(1995年)築27年</option>
                    <option value="28">平成6年(1994年)築28年</option>
                    <option value="29">平成5年(1993年)築29年</option>
                    <option value="30">平成4年(1992年)築30年</option>
                    <option value="31">平成3年(1991年)築31年</option>
                    <option value="32">平成2年(1990年)築32年</option>
                    <option value="33">平成1年(1989年)築33年</option>
                    <option value="34">昭和63年(1988年)築34年</option>
                    <option value="35">昭和62年(1987年)築35年</option>
                    <option value="36">昭和61年(1986年)築36年</option>
                    <option value="37">昭和60年(1985年)築37年</option>
                    <option value="38">昭和59年(1984年)築38年</option>
                    <option value="39">昭和58年(1983年)築39年</option>
                    <option value="40">昭和57年(1982年)築40年</option>
                    <option value="41">昭和56年(1981年)築41年</option>
                    <option value="42">昭和55年(1980年)築42年</option>
                    <option value="43">昭和54年(1979年)築43年</option>
                    <option value="44">昭和53年(1978年)築44年</option>
                    <option value="45">昭和52年(1977年)築45年</option>
                    <option value="46">昭和51年(1976年)築46年</option>
                    <option value="47">昭和50年(1975年)築47年</option>
                    <option value="48">昭和49年(1974年)築48年</option>
                    <option value="49">昭和48年(1973年)築49年</option>
                    <option value="50">昭和47年(1972年)築50年</option>
                    <option value="51">昭和46年(1971年)築51年</option>
                    <option value="52">昭和45年(1970年)築52年</option>
                    <option value="53">昭和44年(1969年)築53年</option>
                    <option value="54">昭和43年(1968年)築54年</option>
                    <option value="55">昭和42年(1967年)築55年</option>
                    <option value="56">昭和41年(1966年)築56年</option>
                    <option value="57">昭和40年(1965年)築57年</option>
                    <option value="58">昭和39年(1964年)築58年</option>
                    <option value="59">昭和38年(1963年)築60年</option>
                    <option value="60">昭和37年(1962年)築61年</option>
                    <option value="61">昭和36年(1961年)築62年</option>
                  </select>

                </div>
                <div class="input-group input-group-sm mb-3">
                  <div class="input-group-prepend"> <span class="input-group-text">建物構造　</span> </div>
                  <select type="tel" class="form-control auto_propertytaxbuilding" id="construction">

                    　　 <option value="0">木造</option>
                    <option value="1">木造（耐火性能有）</option>
                    <option value="2">軽量鉄骨（厚さ３mm以下）</option>
                    <option value="3">軽量鉄骨（厚さ４mm以下）</option>
                    　　　　<option value="4">重量鉄骨</option>
                    　　　　<option value="5">RC・SRC</option>
                    <option value="6">区分マンション</option>
                  </select>
                </div>
                <div class="input-group input-group-sm mb-3">
                  <div class="input-group-prepend"> <span class="input-group-text">建物の種類</span> </div>
                  <select type="tel" class="form-control auto_propertytaxbuilding" id="purpose">
                    　<option value="1" selected>住居用の建物</option>
                    <option value="0">住居用以外の建物</option>
                  </select>

                </div>

                　　
            </form>
          </div>
        </div>
        <div class="col-lg-3 border rounded">

          <form>
            <div class="form-group">
              <div class="card-header mb-5 mt-4 text-center w-100">固定資産税評価額</div>
              <div class="input-group input-group-sm">
                <div class="input-group-prepend"> <span class="input-group-text">土地価額</span> </div>
                <input type="tel" class="form-control auto_propertytaxland text-right" id="valuation_propertytax_land"
                  value="0" min="0">
                <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
                <div class="input-group w-100">
                  <div class="input-group-prepend w-100">
                    <div class="input-group-text mt-1 w-100">
                      <input class="auto_propertytaxland auto" type="checkbox" id="auto_valuation_propertytax_land"
                        value="auto">：土地面積・路線価から自動計算<br>
                    </div>
                  </div>

                </div>
              </div>
            </div>
            <div class="input-group input-group-sm mb-3">
              <div class="input-group-prepend"> <span class="input-group-text">建物価額</span> </div>
              <input type="tel" class="form-control auto_propertytaxbuilding text-right"
                id="valuation_propertytax_building" value="0" min="0">
              <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
              <div class="input-group w-100">
                <div class="input-group-prepend w-100">
                  <div class="input-group-text mt-1 w-100">
                    <input class="auto_propertytaxbuilding auto" type="checkbox"
                      id="auto_valuation_propertytax_building" value="auto">：構造・床面積・築年数から自動計算<br>
                  </div>
          </form>

        </div>
      </div>
    </div>
    </form>
  </div>
  </form>
  </div>
  </form>
  <div class="row">
    <div class="col-lg-3 border rounded">
      <form>
        <div class="form-group">
          <div class="card-header mb-5 mt-4 text-center w-100 w-100">減価償却対象額</div>
          <div class="input-group input-group-sm">
            <div class="input-group-prepend"> <span class="input-group-text">土地価額　　　　　　　</span> </div>
            <input type="tel" class="form-control propertyamount text-right" name="price_land" id="price_land" min="0">
            <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
          </div>


          <div class="input-group input-group-sm mt-0 mb-0">
            <div class="input-group-prepend"> <span class="input-group-text">建物価額　　　　　　　</span> </div>
            <input disabled type="tel" class="form-control propertyamount text-right" id="price_building" value="0"
              min="0">
            <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
          </div>
          <div class="input-group input-group-sm">
            <div class="input-group-prepend"> <span class="input-group-text">消費税　　　　　　　　</span> </div>
            <input disabled type="tel" class="form-control propertyamount text-right" id="consumpiton_tax" value="0"
              min="0">
            <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
          </div>
          <div class="input-group-text mt-1 w-100">
            <input class="auto_price_land auto" type="checkbox" value="auto">：固定資産税評価額から自動計算<br>
          </div>

          <div class="input-group mb-3"></div>
          <div class="input-group input-group-sm mb-3">
            <div class="input-group-prepend"> <span class="input-group-text">土地建物仲介手数料　　</span> </div>
            <input type="tel" class="form-control propertyamount text-right" id="brokerage_fee_i" min="0">
            <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>

            <div class="input-group input-group-sm ">
              <div class="input-group-prepend"> <span class="input-group-text">建物仲介手数料　　　　</span> </div>
              <input disabled type="tel" class="form-control propertyamount text-right" id="brokerage_fee_building"
                value="0" min="0">
              <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
            </div>
            <div class="input-group-text mt-1 w-100">
              <input class="auto_brokerage_fee" type="checkbox" value="auto" checked="true">：仲介手数料自動計算<br>
            </div>
            <div class="input-group mb-3">






              <div class="input-group mb-3"></div>
              <div class="input-group-prepend"> <span class="input-group-text">減価償却対象合計額</span> </div>
              <input disabled type="tel" class="form-control propertyamount text-right" id="depre_price" min="0">
              <div class="input-group-prepend"> <span class="input-group-text">万円</span> </div>
              <div class="input-group mb-3"></div>
            </div>
      </form>
    </div>
  </div>
  </form>
  </div>
  <div class="col-lg-3 border rounded">
    <form>
      <div class="form-group">
        <div class="card-header mb-5 mt-4 text-center w-100 w-100">火災保険・地震保険</div>
        <div class="input-group input-group-sm">
          <div class="input-group-prepend"> <span class="input-group-text">火災保険加入額　　　</span> </div>
          <input type="tel" class="form-control propertyamount text-right" name="price_land" id="insurance_amount"
            value="0" min="0">
          <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
          <div class="input-group-prepend w-100">
            <div class="input-group-text mt-1 w-100">
              <input class="auto" type="checkbox" id="auto_insurance_amount">：火災保険加入額＝建物価格<br>
            </div>
          </div>
        </div>


        <div class="input-group input-group-sm mt-2 mb-0">
          <div class="input-group-prepend"> <span class="input-group-text">火災保険（単年）　　</span> </div>
          <input disabled type="tel" class="form-control propertyamount insurance_fire text-right" value="0" min="0">
          <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
        </div>
        <div class="input-group input-group-sm">
          <div class="input-group-prepend"> <span class="input-group-text">地震保険（単年）　　</span> </div>
          <input disabled type="tel" class="form-control propertyamount insurance_earthquake text-right" value="0"
            min="0">
          <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
        </div>
        <div class="input-group input-group-sm">
          <div class="input-group-prepend"> <span class="input-group-text">保険料合計（単年）　</span> </div>
          <input disabled type="tel" class="form-control propertyamount insurance_total text-right" value="0" min="0">
          <div class="input-group-prepend"> <span class="input-group-text">万円　</span> </div>
        </div>




    </form>
  </div>
  </div>
  </form>





  <div class="col-lg-3 border rounded">
    <form>
      <div class="form-group">
        <div class="card-header mb-2 mt-4 text-center w-100 w-100">銀行ローン計算</div>
        <div class="input-group input-group-sm mt-5 mb-3">
          <div class="input-group-prepend"> <span class="input-group-text">借入額　　　　</span> </div>
          <input class="form-control ads text-right has-success" type="tel" id="loan_amount" value="0" min="0"><br>
          <div class="input-group-prepend"> <span class="input-group-text">万円</span> </div>
          <div class="input-group mb-3">
            <div class="input-group-prepend">

            </div>
          </div>
        </div>
        <div class="input-group input-group-sm mb-3">
          <div class="input-group-prepend"> <span class="input-group-text">借入期間　　　</span> </div>
          <input class="form-control ads text-right" type="tel" id="loan_period" value="0" min="0"><br>
          <div class="input-group-prepend"> <span class="input-group-text">年　</span> </div>
          <div class="input-group mb-3">
            <div class="input-group-prepend">

            </div>
          </div>
        </div>
        <div class="input-group input-group-sm mb-3">
          <div class="input-group-prepend"> <span class="input-group-text">金利　　　　　</span> </div>
          <input class="form-control ads text-right" type="tel" id="loan_rate" value="2.0" min="0" step="0.1"><br>
          <div class="input-group-prepend"> <span class="input-group-text">％　</span> </div>
          <div class="input-group mb-3">
            <div class="input-group-prepend">

            </div>
          </div>
        </div>
      </div>
      <div class="input-group input-group-sm mb-3">
        <div class="input-group-prepend"> <span class="input-group-text">年間返済額　　</span> </div>
        <input disabled type="tel" class="form-control text-right" id="ads" value="0" min="0">
        <div class="input-group-prepend"> <span class="input-group-text">万円</span> </div>
        <div class="input-group mb-0">
          <div class="input-group-prepend">

          </div>
        </div>
        <div class="input-group-prepend"> <span class="input-group-text">Ｋ％　　　　　 </span> </div>
        <input disabled type="tel" class="form-control text-right" id="kpc" value="0" min="0">
        <div class="input-group-prepend"> <span class="input-group-text">％　</span> </div>

    </form>
  </div>
  </form>
  </div>
  <div class="col-lg-3 border rounded">
    <form>
      <div class="form-group">
        <div class="card-header mb-2 mt-4 text-center w-100 w-100">総潜在収入（GPI)</div>
        <div class="input-group input-group-sm mt-5 mb-3">
          <div class="input-group-prepend"> <span class="input-group-text">総戸数　　　　　</span> </div>
          <input type="tel" class="form-control opex gpi text-right" id="units" placeholder="10" min="1" step="1">
          <div class="input-group-prepend"> <span class="input-group-text">戸　</span> </div>
          <div class="input-group mb-3">
            <div class="input-group-prepend">

            </div>
          </div>
        </div>
        <div class="input-group input-group-sm mb-3">
          <div class="input-group-prepend"> <span class="input-group-text">戸あたり月額賃料</span> </div>
          <input type="tel" class="form-control opex gpi text-right" id="gpi_room_month" placeholder="7" min="0"
            step="0.5">
          <div class="input-group-prepend"> <span class="input-group-text">万円</span> </div>
          <div class="input-group mb-3">
            <div class="input-group-prepend">

            </div>
          </div>
        </div>
        <div class="input-group input-group-sm">
          <div class="input-group-prepend"> <span class="input-group-text">年間総潜在収入　</span> </div>
          <input type="tel" class="form-control opex gpi text-right" id="gpi" min="0" placeholder="840">
          <div class="input-group-prepend"> <span class="input-group-text">万円</span> </div>
          <div class="input-group mb-3">
            <div class="input-group-prepend">

            </div>
          </div>
        </div>
      </div>
      <div id="accordion2" role="tablist">


        <div class="input-groupv input-group-sm mb-0 ">




        </div>
        <div class="input-group input-group-sm">
          <div class="input-group-prepend"> <span class="input-group-text" role="button" data-toggle="collapse"
              data-target="#collapseOne2">賃料下落率の変更　▼</span> </div>


          <div class="input-group mb-1">

          </div>
        </div>
        <div id="collapseOne2" class="collapse" role="tabpanel" aria-labelledby="headingOne1" data-parent="#accordion2">

          <div class="input-group input-group-sm mt-0 mb-0 w-100">
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <span class="input-group-text">新築　　〜　築２年　　</span>
              </div>
              <input type="tel" class="form-control rate_rent_decline text-right" id="rate_rent_decline1" min="0"
                value="0.0">
              <div class="input-group-prepend">
                <span class="input-group-text">％</span>
              </div>

            </div>
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <span class="input-group-text">築３年　〜　築５年　　</span>
              </div>
              <input type="tel" class="form-control rate_rent_decline text-right" id="rate_rent_decline2" value="1.7">
              <div class="input-group-prepend">
                <span class="input-group-text">％</span>
              </div>

            </div>
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <span class="input-group-text">築６年　〜　築１０年　</span>
              </div>
              <input type="tel" class="form-control rate_rent_decline text-right" id="rate_rent_decline3" value="1.7">
              <div class="input-group-prepend">
                <span class="input-group-text">％</span>
              </div>

            </div>
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <span class="input-group-text">築１１年〜　築２０年　</span>
              </div>
              <input type="tel" class="form-control rate_rent_decline text-right" id="rate_rent_decline4" value="0.6">
              <div class="input-group-prepend">
                <span class="input-group-text">％</span>
              </div>

            </div>
            <div class="input-group input-group-sm">
              <div class="input-group-prepend">
                <span class="input-group-text">築２１年以降　　　　　</span>
              </div>
              <input type="tel" class="form-control rate_rent_decline text-right" id="rate_rent_decline5" value="0.1">
              <div class="input-group-prepend">
                <span class="input-group-text">％</span>
              </div>

            </div>














          </div>





        </div>








      </div>

    </form>
  </div>
  </div>
  <div class="row">
    <div class="col-lg-3 border rounded">
      <form>
        <div class="form-group">
          <div class="card-header mb-2 mt-4 text-center w-100 w-100">空室率</div>
          <div class="input-group input-group-sm mt-5 mb-5">
            <div class="input-group-prepend"> <span class="input-group-text">平均入居期間</span> </div>
            <input type="tel" class="form-control opex rate_vacancy text-right" id="occupancy_period" value="24"
              min="1">
            <div class="input-group-prepend"> <span class="input-group-text">ヶ月　</span> </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">

              </div>
            </div>
          </div>
          <div class="input-group input-group-sm mb-5">
            <div class="input-group-prepend"> <span class="input-group-text">平均募集期間</span> </div>
            <input type="tel" class="form-control opex rate_vacancy text-right" id="recruitment_period" placeholder="2"
              min="0">
            <div class="input-group-prepend"> <span class="input-group-text">ヶ月　</span> </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">

              </div>
            </div>
          </div>
          <div class="input-group input-group-sm">
            <div class="input-group-prepend"> <span class="input-group-text">空室率　　　</span> </div>
            <input type="tel" class="form-control opex rate_vacancy text-right" id="initial_rate_vacancy"
              placeholder="7.69" min="0" step="0.1">
            <div class="input-group-prepend"> <span class="input-group-text">％　　</span> </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">

              </div>
            </div>
          </div>
        </div>

      </form>

    </div>
    <div class="col-lg-3 border rounded">
      <form>
        <div class="form-group">
          <div class="card-header mb-2 mt-4 text-center w-100 w-100">運営費</div>
          <div class="input-group input-group-sm mt-5 mb-5">
            <div class="input-group-prepend"> <span class="input-group-text">平均募集費用　　</span> </div>
            <input type="tel" class="form-control opex text-right" id="recruitment_cost_month" placeholder="1" min="0">
            <div class="input-group-prepend"> <span class="input-group-text">ヶ月分</span> </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">

              </div>
            </div>
          </div>
          <div class="input-group input-group-sm mb-5">
            <div class="input-group-prepend"> <span class="input-group-text">平均原状回復費用</span> </div>
            <input type="tel" class="form-control text-right opex" id="recovery_cost_month" placeholder="1" min="0">
            <div class="input-group-prepend"> <span class="input-group-text">ヶ月分</span> </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">

              </div>
            </div>
          </div>
          <div class="input-group input-group-sm">
            <div class="input-group-prepend"> <span class="input-group-text">賃貸管理費　　　</span> </div>
            <input type="tel" class="form-control text-right opex" id="opex_rental_management" value="7.0" min="0"
              step="0.5">
            <div class="input-group-prepend"> <span class="input-group-text">％　　</span> </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">

              </div>
            </div>
          </div>
        </div>

      </form>

    </div>
    <div class="col-lg-3 border rounded">
      <form>
        <div class="form-group">
          <div class="card-header mb-2 mt-4 text-center w-100 w-100">設備</div>
          <div class="input-group input-group-sm mt-5 mb-5">
            <div class="input-group-text mt-0 w-100">
              <input type="checkbox" class="opex facility" value="60" id="d_rb1" />：エレベーター（+60万円)
              　
            </div>
            <div class="input-group-text mt-0 w-100">
              <input type="checkbox" class="opex facility" value="10" id="d_rb2" />：受水槽(+10万円)
              　
            </div>
            <div class="input-group-text mt-0 w-100">
              <input type="checkbox" class="opex facility" value="6" id="d_rb3" />：ケーブルテレビ(+6万円)
              　
            </div>
            <div class="input-group-text mt-0 w-100">
              <input type="checkbox" class="opex facility" value="6" id="d_rb4" />：インターネット(+6万円)
              　
            </div>
            <div class="input-group-text mt-0 w-100">
              <input type="checkbox" class="opex facility" value="10" id="d_rb5" />：植栽(+10万円) 　 　　
              　
            </div>
            <div class="input-group-text mt-0 w-100">
              <input type="checkbox" class="opex facility" value="30" id="d_rb6" />：高圧受電設備(+30万円）
              　
            </div>
          </div>


      </form>
    </div>
  </div>
  <div class="col-lg-3 border rounded">
    <form>
      <div class="form-group">
        <div class="card-header mb-2 mt-4 text-center w-100 w-100">相続税</div>
        <div class="input-group input-group-sm mt-5 mb-0">
          <div class="input-group-prepend"> <span class="input-group-text">総資産　　　　　　　　　</span> </div>
          <input class="form-control souzoku text-right" id="shisan" min="0" step="1000" type="tel" placeholder="10000">
          <div class="input-group-prepend"> <span class="input-group-text">万円</span> </div>

        </div>
        <div class="input-group input-group-sm mt-0 mb-3">
          <div class="input-group-prepend"> <span class="input-group-text">うち現金資産　　　　　　</span> </div>
          <input class="form-control text-right" id="shisan_cash" placeholder="5000" step="1000" type="tel">
          <div class="input-group-prepend"> <span class="input-group-text">万円</span> </div>
          <div class="input-group mb-3">
            <div class="input-group-prepend">

            </div>
          </div>
        </div>

        <div class="input-group input-group-sm mb-3 souzoku">
          <div class="input-group-prepend"> <span class="input-group-text">配偶者の有無　　　　　　</span> </div>
          <select class="form-control text-center" id="haigu">
            <option value=0 selected>配偶者無し</option>
            <option value=1>配偶者有り</option>
          </select>
        </div>
        <div class="input-group input-group-sm mb-3">
          <div class="input-group-prepend"> <span class="input-group-text">子の数　　　　　　　　　</span> </div>
          <select id="kodomo" class="form-control souzoku text-center">
            <option value=1 selected>1名</option>
            <option value=2>2名</option>
            <option value=3>3名</option>
            <option value=4>4名</option>
            <option value=5>5名</option>
            <option value=6>6名</option>
            <option value=7>7名</option>
            <option value=8>8名</option>
            <option value=9>9名</option>
            　
          </select>

        </div>
        <div class="input-group input-group-sm mt-5 mb-5">
          <div class="input-group-prepend"> <span class="input-group-text">現状の相続税額　　　　　</span> </div>
          <input disabled class="form-control souzoku text-right" id="souzokuzei" value="0" min="0" type="tel">
          <div class="input-group-prepend"> <span class="input-group-text">万円</span> </div>
          <div class="input-group mb-3">
            <div class="input-group-prepend">

            </div>
          </div>
        </div>
        <div class="input-group input-group-sm mt-5 mb-5">
          <div class="input-group-prepend"> <span class="input-group-text">小規模宅地の特例適用面積</span> </div>
          <input class="form-control special_aa text-right" type="tel" id="inheritance_special_area" value="0" max="200"
            min="1"><br>
          <div class="input-group-prepend"> <span class="input-group-text">㎡　</span> </div>
          <div class="input-group mb-3">
            <div class="input-group-prepend">

            </div>
          </div>
        </div>
      </div>

    </form>
  </div>

  </div>
  <div class="row">
    <div class="col-lg-3 border rounded">
      <form>
        <div class="form-group">
          <div class="card-header mb-2 mt-4 text-center w-100 w-100">購入者情報</div>
          <div class="input-group input-group-sm mt-5 mb-5">
            <div class="input-group-prepend"> <span class="input-group-text">オーナーの年齢</span> </div>
            <input type="tel" class="form-control text-right" id="initial_ownerage" value="50" min="0" step="1">
            <div class="input-group-prepend"> <span class="input-group-text">歳　</span> </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">

              </div>
            </div>
          </div>
          <div class="input-group input-group-sm mb-5">

            <div class="input-group input-group-sm mb-3">
              <div class="input-group-prepend"> <span class="input-group-text">購入名義　　　</span> </div>
              <select class="form-control" required id="PorC">
                <option value=0 >法人</option>
                <option value=1 selected>個人</option>
                　　　　
              </select>
            </div> 
          </div>
          <div class="input-group input-group-sm mt-5 mb-5">
            <div class="input-group-prepend"> <span class="input-group-text">所得税等税率　</span> </div>
            <input type="tel" class="form-control text-right" id="rate_income_tax" value="30.0" min="0">
            <div class="input-group-prepend"> <span class="input-group-text">％　</span> </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">

              </div>
            </div>
          </div>


        </div>

      </form>
    </div>
    <div class="col-lg-3 border rounded">
      <form>
        <div class="form-group">
          <div class="card-header mb-2 mt-4 text-center w-100 w-100">分析条件</div>
          <div class="input-group input-group-sm mt-5 mb-3">
            <div class="input-group-prepend"> <span class="input-group-text">分析期間　　　　　　</span> </div>
            <input type="tel" class="form-control text-right" id="analysis_period" value="30" min="1">
            <div class="input-group-prepend"> <span class="input-group-text">年間</span> </div>
            <div class="input-group mb-3">
              <div class="input-group-prepend">

              </div>
            </div>
          </div>
          <div class="input-group input-group-sm mb-3">

            <div class="input-group input-group-sm ">
              <div class="input-group-prepend"> <span class="input-group-text">割引率　　　　　　　</span> </div>
              <input type="tel" class="form-control text-right" id="discount_rate" value="1.0" step="0.1">
              <div class="input-group-prepend"> <span class="input-group-text">％　</span> </div>
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                </div>
              </div>
            </div>
          </div>
          <div class="input-group input-group-sm mb-3">

            <div class="input-group input-group-sm ">
              <div class="input-group-prepend"> <span class="input-group-text">売却時CR加算率　　　</span> </div>
              <input type="tel" class="form-control text-right" id="rate_pluscap" value="1.0" step="0.1">
              <div class="input-group-prepend"> <span class="input-group-text">％　</span> </div>
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                </div>
              </div>
            </div>
          </div>
          <div class="input-group input-group-sm mb-3">

            <div class="input-group input-group-sm">
              <div class="input-group-prepend"> <span class="input-group-text">売却時経費率　　　　</span> </div>
              <input type="tel" class="form-control text-right" id="rate_sale" value="4.0" min="0" step="0.1">
              <div class="input-group-prepend"> <span class="input-group-text">％　</span> </div>
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                </div>
              </div>
            </div>
          </div>
          <div class="input-group input-group-sm mb-3">

            <div class="input-group input-group-sm">
              <div class="input-group-prepend"> <span class="input-group-text">土地積算評価割戻率　</span> </div>
              <input type="tel" class="form-control text-right" id="rate_cumlative" value="80">
              <div class="input-group-prepend"> <span class="input-group-text">％　</span> </div>
              <div class="input-group mb-3">
                <div class="input-group-prepend">
                </div>
              </div>
            </div>
          </div>
          <input type="tel" class="d-none" id="analysis_start_year" value="2020" min="1950">
          <input type="tel" class="d-none" id="initial_year" value="2020" min="1950">
          <input type="tel" class="d-none" id="consumpiton_tax_rate" value="10" min="1950">

        </div>

      </form>
    </div>
    <div class="col-lg-3 border rounded">
      <form>
        <div class="form-group">
          <div class="card-header mb-2 mt-4 text-center w-100 w-100">コメント</div>
          <div class="input-group input-group-sm mt-5 mb-3">
            <textarea class="form-control" rows="7" id="comment"></textarea>

            <div class="input-group mb-3">

            </div>
          </div>
          <div class="input-group input-group-sm mb-3">

            <div class="input-group input-group-sm mb-3">
              <div class="input-group-prepend"> <span class="input-group-text">YOUTUBE　</span> </div>
              <input type="text" class="form-control address" id="Youtube" value="https://youtu.be/eBWs-E_O_F4">
            </div>
          </div>

          <input type="tel" class="d-none" id="analysis_start_year" value="2020" min="1950">
          <input type="tel" class="d-none" id="initial_year" value="2020" min="1950">
          <input type="tel" class="d-none" id="consumpiton_tax_rate" value="10" min="1950">

        </div>

      </form>
    </div>
    <div class="col-lg-3 border rounded">
      <a href="https://lin.ee/njPVclD" target="_blank"><img src="images/kai_bx.png" class="img-responsive"></a>
      <div class="w-100 text-left">
        　本ソフトはご自由にお使いください。
        但し、本ソフトを使ったことにより損害が発生しても、株式会社鎌倉鑑定は一切の責任を負いません。
        　</div>
      <br>
      <div>




      </div>




    </div>

  </div>
  </form>
  </div>


  <div role="tabpanel" class="tab-pane fade" id="paneTwo1" aria-labelledby="hatstab1">
    <div class="row">
      <div class="col-lg-3 border rounded">
        <form>
          <div class="form-group">

            <div id="accordion1" role="tablist">
              <div class="card">
                <div class="card-header mb-5 mt-4 text-center w-100 w-100">初期費用</div>
                <div class="input-group input-group-sm w-100">
                  <div class="input-group-prepend w-50"> <span class="input-group-text w-100">物件価格　</span> </div>
                  <input disabled type="tel" class="form-control text-right price_property w-30">
                  <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                </div>
                <div class="input-group input-group-sm w-100">
                  <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                      data-toggle="collapse" data-target="#collapseOne1">購入経費合計 ▼　</span> </div>
                  <input type="tel" class="form-control text-right w-30" id="initial_cost" value="0"
                    data-toggle="tooltip" data-placement="right" title="「購入経費合計」総額入力時には「その他の初期費用」で調整します">
                  <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                </div>
                <div id="collapseOne1" class="collapse" role="tabpanel" aria-labelledby="headingOne1"
                  data-parent="#accordion1">
                  　<div class="input-group input-group-sm w-100">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">その他の初期費用　</span> </div>
                    <input type="tel" class="form-control text-right icost w-30" id="other_fee" value="0"
                      data-toggle="tooltip" data-placement="right" title="「購入経費合計」入力時にはここで調整します">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                  　<div class="input-group input-group-sm w-100 mb-1">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">登録免許税（所有権移転）</span>
                    </div>
                    <input type="tel" class="registrationtax_transfer form-control text-right icost w-30"
                      id="registrationtax_transfer" min="0">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                  <div class="input-group input-group-sm w-100 mb-1">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">登録免許税（抵当権設定）</span>
                    </div>
                    <input type="tel" class="registrationtax_mortgage form-control text-right icost w-30"
                      id="registrationtax_mortgage" min="0">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                  <div class="input-group input-group-sm w-100 mb-1">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">不動産取得税（土地）</span> </div>
                    <input type="tel" class="acquisitiontax_land form-control text-right icost w-30"
                      id="acquisitiontax_land" min="0">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                  <div class="input-group input-group-sm w-100 mb-1">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">不動産取得税（建物）</span> </div>
                    <input type="tel" class="acquisitiontax_building form-control text-right icost w-30"
                      id="acquisitiontax_building" min="0">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                  <div class="input-group input-group-sm w-100 mb-1">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">仲介手数料</span> </div>
                    <input disabled type="tel" class="form-control icost text-right w-30" id="brokerage_fee" min="0">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                  <div class="input-group input-group-sm w-100 mb-1">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">司法書士手数料</span> </div>
                    <input type="tel" class="form-control icost text-right w-30 " id="legal_fee" min="0">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                  <div class="input-group input-group-sm w-100 mb-1">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">銀行手数料</span> </div>
                    <input type="tel" class="form-control icost text-right w-30" id="bank_fee" min="0">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                  <div class="input-group input-group-sm w-100 mb-1">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">印紙代（売買契約書）</span> </div>
                    <input disabled type="tel" class="form-control icost text-right w-30" id="Stamptax_transfer"
                      min="0">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                  <div class="input-group input-group-sm w-100 mb-1">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100">印紙代（金消契約書）</span> </div>
                    <input disabled type="tel" class="form-control icost text-right w-30" id="stamptax_loan" min="0">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>
                </div>
                <div class="input-group input-group-sm w-100 mb-1">
                  <div class="input-group-prepend w-50"> <span class="input-group-text w-100">物件価格＋購入経費</span> </div>
                  <input disabled type="tel" id="initial_totalcost"
                    class="form-control text-right initial_totalcost w-30">
                  <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                </div>
                <div class="input-group input-group-sm w-100 mb-1">
                  <div class="input-group-prepend w-50"> <span class="input-group-text w-100">銀行借入額</span> </div>
                  <input disabled type="tel" class="form-control text-right loan_amount w-30">
                  <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                </div>
                <div class="input-group input-group-sm w-100 mb-1">
                  <div class="input-group-prepend w-50"> <span class="input-group-text w-100">投入自己資金</span> </div>
                  <input disabled type="tel" id="equity" class="form-control text-right w-30">
                  <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                </div>
























                <div class="danger">※火災保険・地震保険は運営費用に入っており、初期費用には含まれていません</div>
              </div>
            </div>



          </div>

        </form>

      </div>
      <div class="col-lg-3 border rounded">
        <form>
          <div class="form-group">

            <div id="accordion2" role="tablist">
              <div class="card">
                <div class="card-header mb-5 mt-4 text-center w-100 w-100">運営費用</div>
                <div class="input-groupv input-group-sm mb-0 ">

                  <div class="input-group input-group-sm w-100">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                        data-toggle="collapse" data-target="#collapseOne2">運営費用合計　▼</span> </div>
                    <input type="tel" class="form-control text-right iopex w-30" id="Opex_sum" min="0"
                      data-toggle="tooltip" data-placement="right"
                      title="総額入力・詳細入力どちらでも入力できます。総額入力すると、「その他の運営費用」で自動調整します。">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                  </div>

                  <div class="input-group input-group-sm w-100 mb-2">
                    <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                        data-toggle="collapse" data-target="#collapseOne2">運営費用率</span> </div>
                    <input type="tel" class="form-control text-right iopex w-30" id="Opex_total_rate" min="0"
                      data-toggle="tooltip" data-placement="right" title="費用率を入力すると、「その他の運営費用」で自動調整します。">
                    <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">％　</span> </div>
                  </div>




                </div>
                <div id="collapseOne2" class="collapse" role="tabpanel" aria-labelledby="headingOne1"
                  data-parent="#accordion2">

                  <div class="input-group input-group-sm mt-3 mb-2 w-100">
                    <div class="input-group input-group-sm w-100 mb-4">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">その他の運営費用　</span> </div>
                      <input type="tel" class="form-control text-right iopex w-30" id="opex_other" value="0"
                        data-toggle="tooltip" data-placement="right" title="「運営費用概算」入力時にはここで調整します">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>

                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">固定資産税額：土地　</span> </div>
                      <input type="tel" class="form-control text-right iopex w-30" id="Amount_propertytax_land" min="0">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>

                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">固定資産税額：建物　</span> </div>
                      <input type="tel" class="form-control text-right iopex w-30" id="amount_propertytax_building"
                        min="0">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>


                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">火災保険料</span> </div>
                      <input type="tel" class="form-control text-right iopex insurance_fire w-30" id="insurance_fire"
                        min="0">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>

                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">地震保険料</span> </div>
                      <input type="tel" class="form-control text-right iopex insurance_earthquake w-30"
                        id="insurance_earthquake" min="0">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>

                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">賃貸管理費</span> </div>
                      <input type="tel" class="form-control text-right iopex w-30" id="opex_rental_management_amount"
                        min="0">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>

                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">清掃・消防点検</span> </div>
                      <input type="tel" class="form-control iopex text-right w-30" id="opex_building_management_amount"
                        min="0">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>

                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">設備管理費</span> </div>
                      <input type="tel" class="form-control iopex text-right w-30" id="opex_facility" min="0">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>

                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">共用電気水道代</span> </div>
                      <input type="tel" class="form-control iopex text-right w-30" id="opex_water" min="0">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>

                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">賃貸募集費用　</span> </div>
                      <input type="tel" class="form-control iopex text-right w-30" id="opex_recruitmentcost" min="0">
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>

                    <div class="input-group input-group-sm w-100 mb-1">
                      <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                          data-toggle="collapse" data-target="#collapseOne2">原状回復費用</span> </div>
                      <input type="tel" class="form-control iopex text-right w-30" id="Opex_recoverycost" min="0"><br>
                      <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
                    </div>










                  </div>





                </div>







              </div>
            </div>
          </div>



      </div>

      </form>



      <div class="col-lg-3 border rounded">
        <div class="card-header mb-5 mt-4 text-center w-100 w-100">入力データの保存</div>
        <div class="row">
          <div class="col">
            <a id="link_download" class="btn btn-outline-info" href="#" download onclick="linkDownload()">ダウンロード</a><br>
          </div>
          <div class="col">
            <a class="btn btn-outline-info" href="#" onclick="makeQR()">QRコードを表示</a><br>
          </div>
          <div class="col">
            <a id="copybtn" class="btn btn-outline-info mb-5" href="#">クリップボードコピー</a><br>


          </div>
        </div>


        <a href="https://kkantei.com/contact/" target="_blank">相続税圧縮効果などは概算によるものです。正確な金額は税理士にご確認ください。</a><br><br>
        <a href="https://kkantei.com/contact/"
          target="_blank">不動産コンサルタント・弁護士・税理士・不動産鑑定士・土地家屋調査士による相続・不動産に関する個別相談受付中です</a>





      </div>
      <div class="col-lg-3 border rounded">
        <div class="card-header mb-2 mt-4 text-center w-100 w-100">QRコードの表示</div>
        <img class="w-auto img-fluid" id="googleQR"
          src="https://chart.apis.google.com/chart?cht=qr&chs=130x130&chl=https://kkantei.com">
        <div class="w-auto" id="qrcode"></div>

      </div>
    </div>
  </div>
  <div role="tabpanel" class="tab-pane fade" id="paneTwo2" aria-labelledby="hatstab2">
    <div type="text" class="ef name_property" id="name_property3"></div>


    <div class="row" id="result">
      <div class="col-lg-3">

        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-100"> <span
                class="input-group-text w-100 bg-light text-center">資金内訳　</span> </div>

          </div>
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">物件購入価格　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_price_property"
              data-toggle="tooltip" data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">物件購入価格　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_initial_cost"
              data-toggle="tooltip" data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100 mb-0">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">購入総経費　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_initial_totalcost"
              data-toggle="tooltip" data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100 mb-0">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">銀行借入　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_loan_amount"
              data-toggle="tooltip" data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100 mb-2">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">自己資金　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_equity" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
      </div>
      <div class="col-lg-3">
        <div class="input-group input-group-sm w-100">
          <div class="input-group-prepend w-100"> <span
              class="input-group-text w-100 bg-light text-center">キャッシュフローツリー　</span> </div>

        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">総潜在収入（GPI）　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_gpi" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">実効総収入（EGI）　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_egi" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">運営費（OPEX)　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_opex" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">営業純利益（NOI）　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_noi" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">年間ローン返済額（ADS）　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_ads" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">税引前キャッシュフロー</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_btcf" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">万円</span> </div>
          </div>
        </div>
      </div>
      <div class="col-lg-3">


        <div class="input-group input-group-sm w-100">
          <div class="input-group-prepend w-100 text-center"> <span
              class="input-group-text w-100 bg-light text-center">初年度投資分析　</span> </div>

        </div>

        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">表面利回　　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_surplus" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">％　</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">キャップレート　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_caprate" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">％　</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">総収益率（FCR）　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_fcr" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">％　</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">ローン係数（K%）　</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_kpc" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">％　</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">自己資金利回（CCR）</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_ccr" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">％　</span> </div>
          </div>
        </div>
        <div class="input-groupv input-group-sm w-100 mb-5">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-50"> <span class="input-group-text w-100">安全率（DCR）</span> </div>
            <input disabled id="" 　type="tel" class="w-30 form-control text-right result_dcr" data-toggle="tooltip"
              data-placement="right" title="「運営費用概算」入力時にはここで調整します">
            <div class="input-group-prepend"> <span class="w-20 input-group-text">倍　</span> </div>
          </div>
        </div>


      </div>
      <div class="col-lg-3">


        <div id="accordion3" role="tablist">
          <div class="input-group input-group-sm w-100">
            <div class="input-group-prepend w-100 text-center"> <span
                class="input-group-text w-100 bg-light text-center">相続税圧縮効果　</span> </div>

          </div>
          <div class="card">
            <div class="input-group input-group-sm w-100">
              <div class="input-group-prepend w-50"> <span class="input-group-text w-100">購入前相続税評価額</span> </div>
              <input disabled type="tel" class="form-control text-right shisan w-30">
              <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
            </div>

            <div class="input-group input-group-sm w-100 mb-1">
              <div class="input-group-prepend w-50"> <span class="input-group-text w-100">購入前相続税額</span> </div>
              <input disabled type="tel" class="form-control text-right shisan w-30" id="souzokuzei" min="0">
              <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
            </div>

            <div class="input-group input-group-sm w-100">
              <div class="input-group-prepend w-50"> <span class="input-group-text w-100" role="button"
                  data-toggle="collapse" data-target="#collapseOne3">購入不動産相続税評価額 ▼</span> </div>
              <input disabled type="tel" class="form-control text-right icost w-30 " id="valuation_inheritance_property"
                min="0" value="0">
              <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
            </div>





            <div id="collapseOne3" class="collapse" role="tabpanel" aria-labelledby="headingOne1"
              data-parent="#accordion3">
              <div class="input-group input-group-sm w-100">
                <div class="input-group-prepend w-50"> <span class="input-group-text w-100">建物相続税評価額 </span> </div>
                <input disabled type="tel" class="form-control text-right icost w-30"
                  id="valuation_inheritance_building" min="0" value="0">
                <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
              </div>

              <div class="input-group input-group-sm w-100">
                <div class="input-group-prepend w-50"> <span class="input-group-text w-100">小規模宅地特例土地評価減額 </span> </div>
                <input disabled type="tel" class="form-control text-right icost w-30" id="special_area_amount" min="0">
                <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
              </div>

              <div class="input-group input-group-sm w-100">
                <div class="input-group-prepend w-50"> <span class="input-group-text w-100">土地相続税評価額 </span> </div>
                <input disabled type="tel" class="form-control text-right icost w-30" id="valuation_inheritance_land"
                  min="0">
                <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
              </div>

            </div>

            <div class="input-group input-group-sm w-100 mt-1">
              <div class="input-group-prepend w-50"> <span class="input-group-text w-100">物件価格＋購入経費 </span> </div>
              <input disabled type="tel" class="initial_totalcost form-control text-right icost w-30" 　min="0">
              <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
            </div>

            <div class="input-group input-group-sm w-100">
              <div class="input-group-prepend w-50"> <span class="input-group-text w-100">相続税評価圧縮額 </span> </div>
              <input disabled type="tel" class="form-control text-right icost w-30"
                id="valuation_inheritance_compression" min="0">
              <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
            </div>

            <div class="input-group input-group-sm w-100 mt-1">
              <div class="input-group-prepend w-50"> <span class="input-group-text w-100">購入直後相続税評価額 </span> </div>
              <input disabled type="tel" class="form-control text-right icost w-30" id="valuation_inheritance_after"
                min="0">
              <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
            </div>

            <div class="input-group input-group-sm w-100">
              <div class="input-group-prepend w-50"> <span class="input-group-text w-100">購入直後相続税額 </span> </div>
              <input disabled type="tel" class="form-control w-30 text-right" id="after_souzokuzei" min="0">
              <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
            </div>

            <div class="input-group input-group-sm w-100 mt-1">
              <div class="input-group-prepend w-50"> <span class="input-group-text w-100">相続税圧縮額 </span> </div>
              <input disabled type="tel" class="form-control text-right　w-30 text-right"
                id="amount_inheritance_compression" min="0">
              <div class="input-group-prepend"> <span class="w-20 input-group-text w-20">万円</span> </div>
            </div>




          </div>
        </div>




      </div>
    </div>


    <div class="d-none d-lg-block col-lg-12 border rounded　mt-5">
      <div class="row">
        <canvas class="mt-5" id="cfChart"></canvas>
      </div>
      <form method="post" action="hoge">

        <div class="form-group">
          <p class="control-label"><b>表示するグラフを選択してください。</b></p>
          <div class="row">
            <div class="col">
              <div class="input-group input-group-sm mb-3">
                <div class="input-group-prepend"> <span class="input-group-text">表示データ　</span> </div>
                <select type="text" class="form-control address" id="legend">
                  <option value="000000000000000000000000000000000000000000000">全部表示</option>
                  <option value="111111111111111111111111111111111111111111111">全部非表示</option>
                  <option value="000000111111111111111111111111111111111111111">CFツリー（GPI・EGI・OPEX・NOI・ADS・CF）</option>
                  　　　　<option value="111111001101111111111111111111111111111111111">デッドクロス（ローン元金・減価償却費・ATCF）</option>
                  <option value="111111111100111111111111111111111111111111111" selected>税引後CF（ATCF・累積ATCF）</option>
                  　　　　<option value="111111111110111111111111111111111111111110111">資金回収期間（累積ATCF・投下自己資金）</option>
                  <option value="111111111111001111011111111111111111111111011">売却の検討（売却想定価格・ローン残債・物件購入価格・売却時手取金額（税引後））
                  </option>
                  　　　　<option value="111111111111111111111111111111111110111001111">相続税納税資金の準備（相続税額・現金資産・相続税納税後剰余額）
                  </option>
                  <option value="111111111111111111101111110111111111111111111">IRRとNPV(IRR・NPV）</option>
                  <option value="111111111111111111101111111111111111101111111">相続税圧縮勘案NPV（相続勘案NPV・NPV)</option>
                 


                </select>
              </div>


            </div>
          </div>
      </form>
    </div>
    <div class="d-block d-lg-none col-lg-12 border rounded　">
      <div class="row bg-warning mt-5 mb-5 mr-1 ml-1 border bold shadow">
        <h1>
          PCなどでは、
        </h1><br>
        <h1>
          ここにグラフが表示されます。
        </h1>
      </div>
    </div>

    <!-- Button trigger modal -->


    <div class="col-lg-12 border rounded">
      <div id="cfsheet" style="font-size=5px"></div>
      <div id="analysis"></div>
    </div>



  </div>
  </div>

  </div>
  </div>
  </div>
  </div>
  </div>
  </form>
  </div>
  </form>
  </div>
  </form>
  </div>
  </div>
  </div>
  </div>
  </div>





  <script>

    $(function () {


      //パラメータを取得
      var str = retrieveGETqs();
      tmp_file = decodeURIComponent(str);
      //console.log(tmp_file);
      tmp_file_array = tmp_file.split('=');
      tmp_file_array = tmp_file_array[1].split(',');
      //console.log("length=" + tmp_file_array.length + "file=" + tmp_file_array);
      DATA_LOAD(tmp_file_array);
      SHEET_DRAW();
    })

    //youtube
    window.onload = function () {
      $('.loading').hide('slow');
    };

    // IFrame Player API の読み込み
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    // YouTubeの埋め込み
     var ytPlayer;
     yturl=$('#Youtube').val();
     ytid=youtube_parser(yturl)
     function onYouTubeIframeAPIReady() {
       ytPlayer = new YT.Player(
         'Movie', // 埋め込む場所の指定
         {
           width: 640, // プレーヤーの幅
           height: 480, // プレーヤーの高さ
           videoId: ytid, // YouTubeのID
           playerVars: {
             autoplay: 0 // 自動再生の設定
           }
         }
       );
     }

    var prm;

    function retrieveGETqs() {
      var query = window.location.search.substring(1);
      //console.log("query=" + query);
      if (query != "") {
        //console.log("query=notnull")
        return query;
      }
      else {
        //console.log("query=null")
        return "新築プラン土地建物,13,大田区萩中３−１９−１,16500,138.75,255.66,0,1,346,60,138.75,1,1,4200.66,2556.60,10257.25,5675.23,567.52,201.42,6444.17,5675.23,13000,30,1,501.76,12,7.10,1022.76,24,1,4.00,0,1,0,false,false,false,false,false,false,80000,0,2,29500.00,1,30,2020,50,2020,50,1,4,1,10,80,114.14,52.00,63.01,76.70,532.37,15,11,6,10,170,1050.22,17550.22,14.00,43.46,2.27,7.80,0.00,12.00,0.00,0,0.00,20.31,0,99.84,10.17,2556.60,1968.31,1968.31,3757.93,17550.22,13792.29,22603.85,true,true,true,true,3.86,,https://youtu.be/IXXDqqW5ZcQ,30000";
      }
    }


    //物件所在地の地図
    function initMap() {
      jQuery(function ($) {
        var map, map_center;
        //初期のズーム レベル（指定がなければ 16）
        var zoom = $("#zoom").text() ? parseFloat($("#zoom").text()) : 16;
        //マーカーのタイトル
        var title = $('#venue').text();

        //マップ生成のオプション
        //center は Geolocation から取得して後で設定
        var opts = {
          zoom: zoom,
          mapTypeId: "roadmap"  //初期マップ タイプ  
        };

        //マップのインスタンスを生成
        map = new google.maps.Map(document.getElementById("map_canvas"), opts);

        //ジオコーディングのインスタンスの生成
        var geocoder = new google.maps.Geocoder();

        var address = $('#address_property').val();
        var my_reg = /〒\s?\d{3}(-|ー)\d{4}/;
        //郵便番号を含めるとおかしくなる場合があったので、郵便番号は削除
        address = address.replace(my_reg, '');

        //geocoder.geocode() にアドレスを渡して、コールバック関数を記述して処理
        geocoder.geocode({ 'address': address }, function (results, status) {
          if (status === 'OK' && results[0]) {
            //results[0].geometry.location に緯度・経度のオブジェクトが入っている
            map_center = results[0].geometry.location;
            window.map_center = {
              lat: results[0].geometry.location.lat(),
              lng: results[0].geometry.location.lng()
            }; // add ishihara
            //console.log("map=" + map_center);
            //地図の中心位置を設定
            map.setCenter(map_center);
            //マーカーのインスタンスを生成
            var marker = new google.maps.Marker({
              //マーカーを配置する Map オブジェクトを指定
              map: map,
              //マーカーの初期の場所を示す LatLng を指定  
              position: map_center,
              //マーカーをアニメーションで表示
              animation: google.maps.Animation.DROP,
              title: title
            });

            //情報ウィンドウに表示するコンテンツを作成
            //urlが指定してあればリンクつきのタイトルと住所を表示（URLがない場合もあるため）
            var url = $("#url a").attr('href');
            var content;
            if (url) {
              content = '<div id="map_content"><p><a href="' + url + '" target="_blank"> ' + title + '</a><br />' + address + '</p></div>';
            } else {
              //urlが指定してなければ、リンクなしのタイトルと住所を表示
              content = '<div id="map_content"><p>' + title + '<br />' + address + '</p></div>';
            }

            //情報ウィンドウのインスタンスを生成
            var infowindow = new google.maps.InfoWindow({
              content: content,
            });

            //marker をクリックすると情報ウィンドウを表示(リスナーの登録）
            google.maps.event.addListener(marker, 'click', function () {
              //第2引数にマーカーを指定して紐付け
              infowindow.open(map, marker);
            });
          } else {
            alert("住所から位置の取得ができませんでした。: " + status);
          }
        });
      });
    }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBsh8mqEsvuq2j6JjHubRaME1_rPjgppPM&callback=initMap"
    async defer></script>



  <script>
    var accessibleTabs6 = (function () {

      "use strict";

      var d = document;
      var tabListClass;
      var onClass;
      var hoverableClass;

      var setTabsOff = function (tabList) {
        var i = tabList.tabs.length;
        while (i--) {
          setTab(tabList.tabs[i], false);
        }
      };

      var setTab = function (tab, switchOn) {
        if (tab && tab.panelId) {
          d.getElementById(tab.panelId).setAttribute("aria-hidden", !switchOn);
          tab.setAttribute("aria-selected", switchOn);
          tab.setAttribute("tabindex", switchOn ? "0" : "-1");
        }
      };

      var _activateTab = function (e) {
        var tab = e.target;
        if (e.preventDefault) {
          e.preventDefault();
          setTabsOff(tab.tabList);
          setTab(tab, true);
          d.getElementById(tab.panelId).children[0].focus();
        }
      };

      var _keypressed = function (e) {

        var tab = e.target;
        var newNo = -1;
        var tabs = tab.tabList.tabs;
        var maxNo = tabs.length - 1;

        if (e.keyCode === 37 || e.keyCode === 38) { // left / up arrow
          newNo = (tab.no === 0) ? maxNo : tab.no - 1;
        }
        if (e.keyCode === 39 || e.keyCode === 40) { // right arrow / down arrow
          newNo = (tab.no === maxNo) ? 0 : tab.no + 1;
        }

        if (newNo > -1) {
          setTabsOff(tab.tabList);
          setTab(tabs[newNo], true);
          tabs[newNo].focus();
        }
      };

      var _tabHovered = function (e) {
        var a = e.target;
        var useHover = a.tabList.classList.contains(hoverableClass);
        if (useHover) {
          _activateTab(e);
        }
      };

      var _events = function (tab) {
        tab.addEventListener("click", _activateTab, false);
        tab.addEventListener("keydown", _keypressed, false);
        tab.addEventListener("mouseover", _tabHovered, false);
      };

      var _initialiseAriaAttributes = function (tab) {

        var tabPanel = d.getElementById(tab.panelId);

        tab.parentNode.setAttribute("role", "presentation");
        tab.setAttribute("role", "tab");
        tab.setAttribute("aria-controls", tab.panelId);

        tabPanel.setAttribute("role", "tabpanel");
        tabPanel.setAttribute("aria-labelledby", tab.id);

        // Make first <section> object keyboard focussable
        // Preferably a heading
        // Tabindex=0 to work both forwards and backwards through the keychain
        tabPanel.children[0].setAttribute("tabindex", "0");

      };

      var _setUpConfig = function (cfg) {
        tabListClass = cfg.tabListClass || "tl_list";
        onClass = cfg.onClass || "ON";
        hoverableClass = cfg.hoverableClass || "tl-hoverable";
      };

      var _setUpTab = function (tab, panelId, count) {
        tab.no = count;
        tab.id = "tab-" + panelId;
        tab.panelId = panelId;
        _initialiseAriaAttributes(tab);
        _events(tab);
      };


      var _initialiseTabList = function (tabList) {

        var defaultTab = 0;
        var panelId;
        var tabPanel;
        var i;

        if (tabList) {

          tabList.setAttribute("role", "tablist");
          tabList.tabs = tabList.getElementsByTagName("a");
          i = tabList.tabs.length;

          while (i--) {

            tabList.tabs[i].tabList = tabList;

            panelId = tabList.tabs[i].href.slice(tabList.tabs[i].href.lastIndexOf("#") + 1);
            tabPanel = d.getElementById(panelId);

            if (tabPanel) {
              _setUpTab(tabList.tabs[i], panelId, i);
              if (tabList.tabs[i].classList.contains(onClass)) {
                defaultTab = i;

                // onClass only used to declare intial state, so remove from DOM
                tabList.tabs[i].classList.remove(onClass);
                d.getElementById(panelId).classList.remove(onClass);
              }
            }
          }
          setTabsOff(tabList);
          if (tabList.tabs[defaultTab] && tabList.tabs[defaultTab].panelId) {
            setTab(tabList.tabs[defaultTab], true);
          }
        }
      };

      var _isMustardCut = function (e) {
        // check browser feature support (IE10+)
        return (
          (typeof d.querySelectorAll === "function") &&
          d.addEventListener &&
          !!d.documentElement.classList // IE10+
        );
      };

      var init = function (cfg) {
        var tabLists;
        var i;

        if (_isMustardCut()) {
          _setUpConfig(cfg);
          tabLists = d.getElementsByClassName(tabListClass);
          i = tabLists.length;
          while (i--) {
            _initialiseTabList(tabLists[i]);
          }
        }
      };

      return {
        init: init
      };

    }());


    accessibleTabs6.init({
      tabListClass: "tl_list",   // default, may omit
      onClass: "ON",               // default, may omit
      hoverableClass: "tl-hoverable"  // default, may omit
    });

    ///////////////////////以上タブ処理


    function MAIN() {
      LEGAL_BANK_CALC();
      INITIAL_COST_CAL();
      INHERITANCE();
    }

    function CALC() {
      OPEX_DtoG();
      DATAUPDATE();
      GRAPH_DRAW();
      SHEET_DRAW();
      result();
    }

    //仮設定値
    var name_property;
    var myBarChart;
    var initial_totalcost;
    var analysis_start_year = parseFloat($('#analysis_start_year').val());
    var analysis_period = parseFloat($('#analysis_period').val());
    var initial_year = parseFloat($('#initial_year').val());
    var initial_ownerage = parseFloat($('#initial_ownerage').val());
    //var initial_years_since_purchase=0
    var initial_years_since_construction = parseFloat($('#initial_years_since_construction').val());
    var initial_cap;
    var gpi = [];
    var initial_rate_vacancy = parseFloat($('#initial_rate_vacancy').val());
    var rate_vacancy = [];
    var egi = [];
    var opex_rental_management = parseFloat($('#opex_rental_management').val()) / 100;  //EGIに掛ける
    var opex_rental_management_amount = [];
    var opex_building_management = [];//一部屋あたり
    var opex_building_management_amount = [];
    var opex_recruitmentcost = [];
    var opex_recoverycost = [];
    var opex_tax;//固定資産税別途計算式作成
    var opex_water_electric = [];
    var opex_insurance_earthquake;
    var opex_insurance_fire;
    var opex_recruitment;
    var opex_rate;//=[parseFloat($('#opex_rate').val())];
    var opex_facility = [];
    var opex = [];
    var opex_other = [];
    var opex_sum;
    var opex_total_rate;

    var rate_purchase;
    var rate_income_tax = [parseFloat($('#rate_income_tax').val())];
    var rate_transfer_tax = [];//[parseFloat($('#rate_transfer_tax').val())];
    var rate_pluscap = [parseFloat($('#rate_pluscap').val())];
    var price_sale = [];
    var rate_sale = parseFloat($('#rate_sale').val());
    var noi = [];
    var loan_amount = $('#loan_amount').val();
    var loan_period = 35 * 12;
    var loan_rate = 5 / 12 / 100;
    var cf = [];
    var depre_price;
    var depre_period;
    var depre_unamo;
    var depre_current = [];
    var depre_remain = [];
    var depre_total = [];
    var taxable = [];
    var rate_tax;
    var amount_tax = [];
    var atcf = [];
    var cum_atcf = [0];
    var cum_profit = [0];
    var sell_bftx = [];
    var sell_aftx = [];
    var PorC = ($('#PorC').val());
    var equity;
    var tax_transfer = [];
    var discount_rate;
    var insurance_fire = [];
    var insurance_earthquake = [];
    var initial_cost;//購入時経費（物件価格含まず）
    var loss_carried = [];//購入時費用の繰越欠損金
    var land_rate;//全体価格に対する土地の割合
    var address;//住所
    var prefectures;
    var address_property;
    var price_property;
    var area_land;
    var area_building;
    var construction;
    var road_price;
    var leasehold;
    var inheritance_special_area;
    var shisan;
    var cfdata = [];
    var analysisdata = [];
    var cfsheet;
    var analysis;
    var rate_caprate = [];
    var ytPlayer;
    var yturl = $('#Youtube').val();
    var ytid = youtube_parser(yturl);
    var shisan_cash = [];
    var shisan_realestate = [];
    var valuation_inheritance_total = [];
    var souzokuzei;
    var inheritance_togo = [];
    var fortaxsale = [];



    var slice_year = 20;
    var slice_age_owner;
    var slice_years_since_purchase;
    var slice_years_since_construction;
    var slice_gpi;
    var slice_egi;
    var slice_opex;
    var slice_noi;
    var slice_ads;
    var slice_cf;
    var slice_loan_principal_year;
    var slice_depre_current;
    var slice_taxable;
    var slice_amount_tax;
    var slice_atcf;
    var slice_cum_atcf;
    var slice_rate_falling_rent;
    var slice_price_sale;
    var slice_cum_profit;
    var slice_inheritance_cum_profit
    var slice_sell_bftx;
    var slice_sell_aftx;
    var slice_loan_pv_year;
    var slice_tax_transfer;
    var slice_valuation_inheritance_property;
    var slice_valuation_inheritance_land;
    var slice_valuation_inheritance_building;
    var slice_inheritance_amount;
    var slice_inheritance_compression;
    var slice_bank_total;
    var slice_bank_land;
    var slice_bank_building;
    var slice_insurance_fire = [];
    var slice_insurance_earthquake = [];
    var slice_depre_total = [];
    var slice_shisan_cash = [];
    var slice_valuation_inheritance_total = [];
    var slice_inheritance_togo = [];
    var slice_fortaxsale = [];

    //投資分析用
    var FaCR = [];
    var DeCR = [];
    var Kpc = [];
    var BTCCR = [];
    var ATCCR = [];
    var FLOW = [];
    var IRR = [];
    var IRR_INHERITANCE = [];
    var NPV = [];
    var NPV_INHERITANCE = [];
    var rate_s = [];
    var caprate = [];
    var inheritance_cum_profit = [];
    //初期費用計算用
    var valuation_inheritance_land = [];//土地相続税評価額
    var valuation_inheritance_building = [];//建物相続税評価額
    var valuation_inheritance_property = [];//土地建物相続税評価額
    var inheritance_amount = [];//相続税額
    var inheritance_compression = [];//相続税圧縮額
    var bank_land = [];//土地積算評価
    var bank_building = [];//建物積算評価
    var bank_total = [];//土地建物積算評価
    var bank_building_period;
    var valuation_propertytax_land = [];//土地固定資産税評価額
    var valuation_propertytax_building = [];//建物固定資産税評価額
    var amount_propertytax_land = [];//土地固定資産税額
    var amount_propertytax_building = [];//建物固定資産税額
    var price_land = [];//土地売買価格←入力無ければ固定資産税案分
    var price_building = [];//建物売買価格←入力無ければ固定資産税案分
    var price_net = [];//税抜正味価格(price_land+price_building)
    var acquisitiontax_land;//土地不動産取得税
    var acquisitiontax_building;//建物不動産取得税
    var registrationtax_transfer;//不動産所有権移転登録免許税
    var registrationtax_mortgage;//抵当権設定登録免許税
    var stamptax_transfer;//売買契約印紙税
    var stamptax_loan;//金銭消費貸借契約印紙税
    var stamptax_arc;//建築請負契約印紙税
    var brokerage_fee;//仲介手数料
    var brokerage_fee_land;//仲介手数料土地部分
    var brokerage_fee_building;//仲介手数料建物部分
    var legal_fee;//司法書士手数料
    var bank_fee;//銀行手数料
    var other_cost;//その他
    var repair_depreciation = [];//資本的支出
    var repair_depreciation_period;//資本的支出償却期間
    var repair_expense = [];//一括経費修繕費
    var consumpiton_tax;//建物消費税
    var consumpiton_tax_rate = $('#consumpiton_tax_rate').val() / 100;//建物消費税率
    var insurance_amount;//火災保険加入額
    var valuation_small_residential;//固定資産税額計算用（小規模宅地）
    var valuation_general_residential//固定資産税額計算用（一般宅地）
    var unitprice_valuation_propertytax_land;//固定資産税額計算用（平米単価）
    var legendShow = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];//税引き後CF
    var legendSave = [];
    var graph_zeroline = [];
    var graph_equity = [];
    var graph_totalcost = [];



    $('#button_url_rosenka').click(function () {
      return;
      window.open($('#url_rosenka').val(), '_blank');
      return;
    })

    $('#button_url_property').click(function () {
      window.open($('#url_property').val(), '_blank');
      return;
    })
    //自動入力項目

    $('#address_property').change(function () {
      initMap();
    })

    //建築スタイル変更
    $('#build_style').change(function(){
      build_style();
    })


    //住所
    $('.address').change(function () {
      address_property = $('#address_property').val();
      address = $('#prefectures option:selected').text() + address_property;

    })

    //物件価格・土地面積・建物面積
    $('#price_property,#area_land,#area_building,#construction,#initial_years_since_construction,#road_price,#leasehold').change(function () {
      PROPORTIONAL_CALCULATE();
    })

    //初期費用変更による再計算
    $('.icost').change(function () {
      INITIAL_COST_CAL();
    })

    //初期経費総額を変更した場合にその他で調整
    $('#initial_cost').focusin(function () {
      $(this).data('val', $(this).val());
    });
    $('#initial_cost').on('change', function () {
      var prev = $(this).data('val');
      var current = $(this).val();
      other_fee = current - prev;
      //console.log("prev=" + prev + "current=" + current);
      $('#other_fee').val(other_fee.toFixed(2));
      INITIAL_COST_CAL();
    });

    //運営費を変更した場合にその他で調整
    $('#Opex_sum').focusin(function () {
      $(this).data('val', $(this).val());
    });
    $('#Opex_sum').on('change', function () {
      var prev = parseFloat($(this).data('val'));
      var current = parseFloat($(this).val());
      other_fee = parseFloat($('#opex_other').val()) + current - prev;
      $('#opex_other').val(other_fee.toFixed(2));
      OPEX_DtoG();
    });

    //運営費率を変更した場合にその他で調整
    $('#Opex_total_rate').focusin(function () {
      $(this).data('val', $(this).val());
    });
    $('#Opex_total_rate').on('change', function () {
      var prev = $(this).data('val');
      var current = $(this).val();
      var prev_amount = egi[0] * parseFloat(prev) / 100;
      var current_amount = egi[0] * parseFloat(current) / 100;
      other_fee = current_amount - prev_amount;
      $('#opex_other').val(other_fee.toFixed(2));
      OPEX_DtoG();
    });


    //諸経費変更による再計算
    $('.iopex').change(function () {
      OPEX_DtoG();
    })

    //小規模宅地の特例
    $('.special_aa').change(function () {
      var tmp_area = ($('#area_land').val());
      var tmp_specialarea = parseFloat($('#inheritance_special_area').val());
      if (200 < tmp_specialarea) { tmp_specialarea = 200 };
      if (tmp_area < tmp_specialarea) { tmp_specialarea = tmp_area };
      $('#inheritance_special_area').val(tmp_specialarea);
      return
    })


    //原状回復費用計算

    $('#recovery_cost_month').change(function () {
      opex_recoverycost[0] = egi[0] / 12 * parseFloat($('#recovery_cost_month').val()) / ((parseFloat(($('#occupancy_period').val())) / 12));
      $('#Opex_recoverycost').val(opex_recoverycost[0].toFixed(2));
      return;
    });

    //募集費用計算
    $('#recruitment_cost_month').change(function () {
      opex_recruitmentcost[0] = egi[0] / 12 * parseFloat($('#recruitment_cost_month').val()) / ((parseFloat(($('#occupancy_period').val())) / 12));
      $('#opex_recruitmentcost').val(opex_recruitmentcost[0].toFixed(2));
      return;
    });

    //セーブデータをクリップボードにコピー

    $('#copybtn').on('click', function () {
      //　テキストエリアを選択
      var copycontent = "https://souzoku-tool.club/kamakan.html?=" + DATA_SAVE();
      var ta = document.createElement("textarea")
      ta.value = copycontent
      document.body.appendChild(ta)
      ta.select()
      document.execCommand("copy")
      ta.parentElement.removeChild(ta)
      // コピー
      // アラート文の表示
      $('#js-copyalert').show().delay(2000).fadeOut(400);
    });

    $('#Youtube').on('change', function () {
      movie();
    });

    //データ確認タブ押した時
    $('#hatstab1').click(function () {
      OPEX_ItoD();
      LOAN_CALC();
      INHERITANCE();
      LEGAL_BANK_CALC();
      INITIAL_COST_CAL();
      //stamptax();


      /*
      REGISTRATIONTAX_ACQUISITIONTAX();
      stamptax();
      LEGAL_BANK_CALC();
      OPEX_DtoG();
      */
    })

    //グラフ表示タブ押した時
    $('#hatstab2').click(function () {
      INHERITANCE();
      OPEX_DtoG();
      CALC();
      setTimeout("SHEET_DRAW()", 200)


    })

    function build_style(){
      build_style = $('#build_style').val()
      switch(build_style){
        case "1":
          valuation_inheritance_land[0] = tmp_road_price * tmp_area_land * tmp_leasehold / 10;
          acquisitiontax_land = valuation_propertytax_land * 0.015;
          registrationtax_transfer = (valuation_propertytax_land[0] * 0.015) + (valuation_propertytax_building[0] * 0.02);
 
          break;
        case "2":
          valuation_inheritance_land[0] = 0;
          acquisitiontax_land = 0;
          $('.auto_price_land').prop("checked", false)
          $('#price_land').val(0);
          AUTO_depre_amount();
          registrationtax_transfer = valuation_propertytax_building[0] * 0.02
          break;
        case "3":
          valuation_inheritance_land[0] = 0;
          acquisitiontax_land = 0;
          $('.auto_price_land').prop("checked", false)
          $('#price_land').val(0);
          AUTO_depre_amount();
          break;
         
      }
      alert("dddd")
      $('#registrationtax_transfer').val((registrationtax_transfer).toFixed(2));
      $('#acquisitiontax_land').val(acquisitiontax_land);
      $('#valuation_inheritance_land').val(valuation_propertytax_land[0]);
      return;
    }


    function movie() {
      yturl = $('#Youtube').val();
      if (yturl == "") { yturl = "https://youtu.be/eBWs-E_O_F4" }
      ytid = youtube_parser(yturl)
      //console.log("yturl==" + yturl + "ytid===" + ytid + "#" + $('#Youtube').val())
      ytPlayer.loadVideoById(ytid);
    }

    function youtube_parser(url) {
      var regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
      var match = url.match(regExp);
      return (match && match[7].length == 11) ? match[7] : false;
    }


    ///消費税率　売買契約のみ。仲介手数料はいつも１０％
    $('#consumpiton_tax_rate').change(function () {
      consumpiton_tax_rate = $('#consumpiton_tax_rate').val() / 100;
    });

    ///司法書士手数料・銀行手数料
    function LEGAL_BANK_CALC() {
      if ($('#legal_fee').val() == "") {
        if ($('#loan_amount').val() < 1) {
          legal_fee = 10;
        }
        else {
          legal_fee = 15;
        }
      }
    else{
      legal_fee=$('#legal_fee').val();
    }  
      if ($('#bank_fee').val() == "") {
        if ($('#loan_amount').val() < 1) {
          bank_fee = 0;
        }
        else {
          bank_fee = 11;
        }
      }
      else{
        bank_fee=$('#bank_fee').val();
      }
      $('#legal_fee').val(legal_fee);
      $('#bank_fee').val(bank_fee);
      return;
    }






    function INITIAL_COST_CAL() {
      //初期費用合計計算 確認画面からグラフ画面へ
      //REGISTRATIONTAX_ACQUISITIONTAX();
      registrationtax_transfer = parseFloat($('#registrationtax_transfer').val());
      registrationtax_mortgage = parseFloat($('#registrationtax_mortgage').val());
      acquisitiontax_land = parseFloat($('#acquisitiontax_land').val());
      acquisitiontax_building = parseFloat($('#acquisitiontax_building').val());
      brokerage_fee = parseFloat($('#brokerage_fee').val());
      legal_fee = parseFloat($('#legal_fee').val());
      bank_fee = parseFloat($('#bank_fee').val());
      stamptax_transfer = parseFloat($('#Stamptax_transfer').val());
      stamptax_loan = parseFloat($('#stamptax_loan').val());
      other_fee = parseFloat($('#other_fee').val());
      price_property = parseFloat($('#price_property').val());
      initial_cost = registrationtax_transfer + registrationtax_mortgage + acquisitiontax_land + acquisitiontax_building + brokerage_fee + legal_fee + bank_fee + stamptax_transfer + stamptax_loan + other_fee;
      initial_totalcost = initial_cost + price_property;
      equity = parseFloat(initial_totalcost - parseFloat($('#loan_amount').val()));
      $('#initial_cost').val(initial_cost.toFixed(2));
      $('#initial_totalcost,.initial_totalcost').val(initial_totalcost.toFixed(2));
      $('#equity').val(equity.toFixed(2));
      return;//追加
    }

    function OPEX_DtoG() {
      //運営費用合計計算　確認画面からグラフ画面へ
      var tmp_initial_rate_vacancy = $('#initial_rate_vacancy').val() / 100;
      var tmp_gpi = parseFloat($('#gpi').val())
      egi[0] = parseFloat($('#gpi').val()) * (1 - tmp_initial_rate_vacancy);
      insurance_fire[0] = parseFloat($('#insurance_fire').val());
      insurance_earthquake[0] = parseFloat($('#insurance_earthquake').val());
      opex_rental_management_amount[0] = parseFloat($('#opex_rental_management_amount').val());
      opex_building_management_amount[0] = parseFloat($('#opex_building_management_amount').val());
      opex_recruitmentcost[0] = parseFloat($('#opex_recruitmentcost').val());
      opex_recoverycost[0] = parseFloat($('#Opex_recoverycost').val());
      opex_facility[0] = parseFloat($('#opex_facility').val());
      opex_water_electric[0] = parseFloat($('#opex_water').val());
      amount_propertytax_building[0] = parseFloat($('#amount_propertytax_building').val());
      amount_propertytax_land[0] = parseFloat($('#Amount_propertytax_land').val());
      opex_other[0] = parseFloat($('#opex_other').val());
      opex[0] = insurance_fire[0] + insurance_earthquake[0] + opex_rental_management_amount[0] + opex_building_management_amount[0] + opex_recruitmentcost[0] + opex_recoverycost[0] + opex_facility[0] + opex_water_electric[0] + amount_propertytax_building[0] + amount_propertytax_land[0] + opex_other[0];

      $('#Opex_sum').val(opex[0].toFixed(2));
      $('#Opex_total_rate').val(((opex[0] / egi[0]) * 100).toFixed(2));
      return;//追加
    }


    ///土地固定資産税評価額
    $('.auto_propertytaxland').change(function () {
      if ($('#auto_valuation_propertytax_land').prop("checked")) {
        valuation_propertytax_land[0] = (parseFloat($('#road_price').val()) * parseFloat($('#area_land').val())) / 0.8 * 0.7 / 10;//相続税路線価から固定資産税評価額を計算
        $('#valuation_propertytax_land').val((valuation_propertytax_land[0].toFixed(2)));
      }
      //console.log("roadprice" + parseFloat($('#road_price').val()));
      //console.log("arealand" + parseFloat($('#area_land').val()));
      //console.log("vptl" + valuation_propertytax_land[0]);

      REGISTRATIONTAX_ACQUISITIONTAX();
      AUTO_amount_propertytax_land();

    }
    );

    ///建物固定資産税評価額
    $('.auto_propertytaxbuilding').change(function () {
      if ($('#auto_valuation_propertytax_building').prop("checked")) {
        valuation_propertytax_building[0] = (aging_rate[construction_table[$('#construction').val()][5]][parseFloat($('#initial_years_since_construction').val())]
          * parseFloat($('#area_building').val()) * construction_table[parseFloat($('#construction').val())][1]) / 10000;//構造により経年劣化配列を指定、築年数から経年劣化率を読み取り
        //建物面積×建物固定資産税平米単価
        $('#valuation_propertytax_building').val((valuation_propertytax_building[0].toFixed(2)));
      }
      REGISTRATIONTAX_ACQUISITIONTAX();
      AUTO_amount_propertytax_building();
    }
    );

    ///仲介手数料
    $('.auto_brokerage_fee,.auto_propertytaxbuilding,.auto_propertytaxland,.price_property,#brokerage_fee,#brokerage_fee_i').change(function () {
      AUTO_BROKERAGE_FEE();
      return;
    }
    )

    ///土地建物価格案分計算
    $('.auto_price_land,.auto_propertytaxbuilding,.auto_propertytaxland,.price_property,#price_land').change(function () {
      if (valuation_propertytax_land[0] >= 0 && valuation_propertytax_building >= 0) {
        PROPORTIONAL_CALCULATE();
      }
      else {
        return;
      }
    }
    );
    //console.log("check" + $('legal_fee').val())

    ///土地固定資産税評価額手入力
    $('#valuation_propertytax_land').change(function () {
      if ($('#valuation_propertytax_land').val() < 0) {
        valuation_propertytax_land[0] = 0
      }
      else {
        valuation_propertytax_land[0] = parseFloat($('#valuation_propertytax_land').val());
      }
      $('#valuation_propertytax_land').val(valuation_propertytax_land[0])
    })

    ///減価償却自動計算
    $('#depre_price').change(function () {
      //console.log("減価償却");
      AUTO_depre_amount();
      depre_unamo = depre_price;
      initial_years_since_construction = $('#initial_years_since_construction').val();

      DEPRECIATION(depre_price, depre_unamo, depre_period, initial_years_since_construction);
      ////console.log("depre_price="+depre_price+"depre_price="+depre_unamo+"depre_period="+depre_period+"initial_years_since_construction"+initial_years_since_construction);
    });

    //築年数変更
    $('#initial_years_since_construction').change(function () {
      depre_period = construction_table[parseFloat($('#construction').val())][0]
    })


    ///OPEX
    //GPI（１部屋１ヶ月平均でも入力できるようにした）
    $('#gpi').change(function () {
      //console.log("gpichange");
      GPI_CALC();
    })

    $('#gpi_room_month,#units').change(function () {
      GPI_MONTH_CALC();
      AUTO_amount_propertytax_land();
    })

    //空室率（空室期間／（空室期間＋稼働期間））　
    $('#initial_rate_vacancy').change(function () {
      VACANCY_CALC();
    })
    $('.rate_vacancy').change(function () {
      VACANCY_RATE_CALC();
    })


    //保険料
    $('#insurance_fire,#insurance_earthquake').change(function () {
      $('.insurance_fire').val($('#insurance_fire').val());
      $('.insurance_earthquake').val($('#insurance_earthquake').val());
      $('.insurance_total').val((insurance_fire[0] + insurance_earthquake[0]).toFixed(2));
      OPEX_DtoG();

    })
    $('#insurance_amount,#construction,#initial_years_since_construction,#price_property,.auto_propertytaxbuilding,.auto_propertytaxland,.propertyamount,#prefectures').change(function () {
      INSURANCE();
    })

    //設備
    $('.facility').change(function () {
      facility();
    })

    //共用水道電気
    $('#units').change(function () {
      opex_water_electric[0] = 0.05 * parseFloat($('#units').val()) * 12;
      //console.log("opex_water_electric[0]=" + opex_water_electric[0]);
      $('#opex_water').val((opex_water_electric[0]).toFixed(2));
      return opex_water_electric[0];
    });

    //賃貸管理料率
    $('#opex_rental_management,.rate_vacancy,.gpi').change(function () {
      RENTAL_MANAGEMENT_CALC();
    })

    //ローン計算
    $('.ads').change(function () {
      LOAN_CALC();
      REGISTRATIONTAX_ACQUISITIONTAX();
      stamptax();
      LEGAL_BANK_CALC();
    })
    //相続税
    $('.souzoku').change(function () {
      INHERITANCE();
    })

    //火災保険
    $('#auto_insurance_amount').change(function () {
      INSURANCE();
      $('#insurance_amount').val(insurance_amount);
    })

    //物件名
    $('#name_property').change(function () {
      var tmp_name = $('#name_property').val();
      $('#name_property2,#name_property3').text(tmp_name);
      //console.log("name" + tmp_name);
    })

    //清掃費用
    $('#units,#construction').change(function () {
      opex_building_management_amount[0] = construction_table[parseFloat($('#construction').val())][7] * (parseFloat($('#units').val()));
      $('#building')
      $('#opex_building_management_amount').val((opex_building_management_amount[0]).toFixed(2));

    })

    //凡例の表示
    $('#legend').change(function () {
      var tmp_legend = $('#legend').val();
      //console.log("tmplegend" + tmp_legend)
      for (var i = 0; i < tmp_legend.length; i++) {
        legendShow[i] = parseInt(tmp_legend.slice(i, i + 1));
      }

      //legendShow=$('#legend').val();//[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
      //legendShow=[0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
      //console.log("legendShow" + legendShow)
      GRAPH_DRAW();

    })

    //家賃下落率


    //木造・耐火木造・３m以下軽量鉄骨・４m以下軽量鉄骨・重量鉄骨・RCSRC・区分マンションの配列。
    //それぞれ法定耐用年数・平米単位固定資産税評価・平米積算評価・火災保険基本料金・火災保険加算額・経年劣化配列（aging_rate）耐火性能（有り＝0・無し＝1)・戸あたり年間清掃、消防設備点検費用（区分は管理費修繕積立）
    var construction_table = [
      [22, 100000, 150000, 8200, 270, 2, 1, 2.4],
      [22, 100000, 150000, 4000, 180, 2, 0, 2.4],
      [19, 104000, 150000, 8200, 270, 4, 1, 2.4],
      [27, 104000, 150000, 8200, 270, 3, 1, 2.4],
      [34, 116000, 180000, 4000, 180, 1, 0, 3.6],
      [47, 143000, 200000, 4000, 180, 0, 0, 3.6],
      [47, 143000, 200000, 2600, 110, 0, 0, 24],
    ];

    //構造別経年劣化割合
    var aging_rate = [
      [1, 0.8000, 0.7500, 0.7000, 0.6912, 0.6825, 0.6737, 0.6649, 0.6561, 0.6474, 0.6386, 0.6298, 0.6211, 0.6123, 0.6035, 0.5947, 0.5860, 0.5772, 0.5684, 0.5596, 0.5509, 0.5421, 0.5333, 0.5246, 0.5158, 0.5070, 0.4982, 0.4895, 0.4807, 0.4719, 0.4632, 0.4544, 0.4456, 0.4368, 0.4281, 0.4193, 0.4105, 0.4018, 0.3930, 0.3842, 0.3754, 0.3667, 0.3579, 0.3491, 0.3404, 0.3316, 0.3228, 0.3140, 0.3053, 0.2965, 0.2877, 0.2789, 0.2702, 0.2614, 0.2526, 0.2439, 0.2351, 0.2263, 0.2175, 0.2088, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
      [1, 0.8000, 0.7500, 0.7000, 0.6865, 0.6730, 0.6595, 0.6459, 0.6324, 0.6189, 0.6054, 0.5919, 0.5784, 0.5649, 0.5514, 0.5378, 0.5243, 0.5108, 0.4973, 0.4838, 0.4703, 0.4568, 0.4433, 0.4297, 0.4162, 0.4027, 0.3892, 0.3757, 0.3622, 0.3486, 0.3351, 0.3216, 0.3081, 0.2946, 0.2811, 0.2676, 0.2541, 0.2405, 0.2270, 0.2135, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000, 0.2000],
      [1, 0.80, 0.75, 0.70, 0.68, 0.65, 0.63, 0.61, 0.59, 0.56, 0.54, 0.52, 0.50, 0.47, 0.45, 0.43, 0.40, 0.38, 0.36, 0.34, 0.31, 0.29, 0.27, 0.25, 0.22, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20, 0.20],
      [1, 0.8, 0.75, 0.7, 0.6815, 0.663, 0.6444, 0.6259, 0.6074, 0.5889, 0.5704, 0.5519, 0.5333, 0.5148, 0.4963, 0.4778, 0.4593, 0.4407, 0.4222, 0.4037, 0.3852, 0.3667, 0.3481, 0.3296, 0.3111, 0.2926, 0.2741, 0.2556, 0.237, 0.2185, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2],
      [1, 0.8, 0.75, 0.7, 0.6706, 0.6412, 0.6118, 0.5824, 0.5529, 0.5235, 0.4941, 0.4647, 0.4353, 0.4059, 0.3765, 0.3471, 0.3176, 0.2882, 0.2588, 0.2294, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2]
    ]
      ;
    //地震保険計算用　０耐火構造・１被耐火構造（都道府県別）
    var earthquake_table = [
      [0.74, 0.74, 0.74, 1.18, 0.74, 0.74, 0.97, 1.77, 0.74, 0.74, 2.04, 2.75, 2.75, 2.75, 0.74, 0.74, 0.74, 0.74, 1.18, 0.74, 0.74, 2.75, 1.18, 1.18, 0.74, 0.74, 1.18, 0.74, 0.74, 1.18, 0.74, 0.74, 0.74, 0.74, 0.74, 1.77, 1.18, 1.18, 1.77, 0.74, 0.74, 0.74, 0.74, 1.18, 1.18, 0.74, 1.18],
      [1.23, 1.23, 1.23, 2.12, 1.23, 1.23, 1.95, 3.66, 1.23, 1.23, 3.66, 4.22, 4.22, 4.22, 1.23, 1.23, 1.23, 1.23, 2.12, 1.23, 1.23, 4.22, 2.12, 2.12, 1.23, 1.23, 2.12, 1.23, 1.23, 2.12, 1.23, 1.23, 1.23, 1.23, 1.23, 4.18, 2.12, 2.12, 4.18, 1.23, 1.23, 1.23, 1.23, 2.12, 2.12, 1.23, 2.12]
    ];

    //初期費用の計算
    function INITIAL() {
      AUTO_valuation_propetytax();
      AUTO_amount_propertytax_land();
      AUTO_amount_propertytax_building();
      AUTO_BROKERAGE_FEE();
      PROPORTIONAL_CALCULATE();
      INSURANCE();
      stamptax();
      INHERITANCE();
      BANK_CALC();
      INITIAL_COST_CAL();
      OPEX_ItoD();
      SHEET_DRAW();
      //Loss_carried();
      return
    };
    function legendallclear() {
      legendShow = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1];
      GRAPH_DRAW();
    }
    function legendsave() {
      legendSave = legendShow.slice();
      //console.log("svlegend" + legendSave)
    }
    function GPI_CALC() {
      if ($('#gpi').val() > 0) {
        gpi = [];
        gpi[0] = parseFloat($('#gpi').val());
        //gpi.push(parseFloat(gpi[0]));
        $('#gpi_room_month').val((gpi[0] / 12 / parseFloat($('#units').val())).toFixed(2));
        return;
      }
    }

    function GPI_MONTH_CALC() {
      if ($('#gpi_room_month').val() > 0) {
        gpi = [];
        gpi[0] = parseFloat($('#gpi_room_month').val() * parseFloat($('#units').val()) * 12);
        $('#gpi').val(gpi[0].toFixed(2));
        //gpi.push(parseFloat(gpi[0]));
        return;
      }
    }

    function VACANCY_CALC() {
      if ($('#initial_rate_vacancy').val() > 0) {
        var occupancy_period = parseFloat($('#occupancy_period').val());
        var recruitment_period = parseFloat($('#recruitment_period').val());
        var tmp_vacancy = parseFloat($('#initial_rate_vacancy').val());
        var tmp_hundred = (100 - tmp_vacancy) / 100;
        var tmp_24 = occupancy_period / tmp_hundred;
        var tmp_period = tmp_24 - occupancy_period;


        $('#recruitment_period').val(tmp_period.toFixed(2));
      }
    }

    function VACANCY_RATE_CALC() {
      var occupancy_period = parseFloat($('#occupancy_period').val());
      var recruitment_period = parseFloat($('#recruitment_period').val());
      if (occupancy_period > 0) {
        initial_rate_vacancy = parseFloat(recruitment_period / (occupancy_period + recruitment_period) * 100);
        $('#initial_rate_vacancy').val((initial_rate_vacancy).toFixed(2));
      }
    }
    /*
    function INHERITANCE_CALC(){
      shisan=parseFloat($('#shisan').val());
      inheritance_amount[0]=Souzokuzeikeisan(shisan);
      $('.shisan').val(shisan.toFixed(2));
      $('#souzokuzei,.souzokuzei').val(inheritance_amount[0].toFixed(2));
      ////console.log("相続税＝"+inheritance_amount[0]);
      return;
    }
    */

    function LOAN_CALC() {
      LOAN_TABLE(parseFloat($('#loan_rate').val() / 100 / 12), parseFloat($('#loan_period').val() * 12), parseFloat($('#loan_amount').val()) + 0.0000001);
      var tmp_kp = (loan_payment * 12) / parseFloat($('#loan_amount').val());
      $('#ads').val((loan_payment * 12).toFixed(2));
      $('#kpc').val((tmp_kp * 100).toFixed(2));
      //console.log("ads=" + loan_pv_year[0] + "loan_payment=" + loan_payment[0] + "loan_payment=" + loan_payment + "loanrate=" + loan_rate + "k%=" + tmp_kp);
      $('.loan_amount').val(parseFloat($('#loan_amount').val()).toFixed(2));
      return;
    }

    function RENTAL_MANAGEMENT_CALC() {
      var tmp_initial_rate_vacancy = $('#initial_rate_vacancy').val() / 100;
      var tmp_opex_rental_management = $('#opex_rental_management').val() / 100;
      var tmp_gpi = parseFloat($('#gpi').val())
      egi[0] = parseFloat($('#gpi').val()) * (1 - tmp_initial_rate_vacancy);
      //console.log("ddd egi[0]=" + egi[0])
      opex_rental_management_amount[0] = egi[0] * tmp_opex_rental_management;//賃貸管理費
      $('#opex_rental_management_amount').val((opex_rental_management_amount[0]).toFixed(2));
      return;
    }

    //固定資産税評価額の計算
    function AUTO_valuation_propetytax() {
      valuation_propertytax_land[0] = (parseFloat($('#road_price').val()) * parseFloat($('#area_land').val())) / 0.8 * 0.7 / 10;//相続税路線価から固定資産税評価額を計算
      valuation_propertytax_building[0] = aging_rate[construction_table[$('#construction').val()][5]][$('#initial_years_since_construction').val()]
        * parseFloat($('#area_building').val()) * construction_table[parseFloat($('#construction').val())][1] / 10000;//構造により経年劣化配列を指定、築年数から経年劣化率を読み取り
      //建物面積×建物固定資産税平米単価
      return;
    };

    //固定資産税の計算
    function AUTO_amount_propertytax_land() {
      ///土地
      var area_small_residential = 200 * ($('#units').val())//居住用の場合は戸あたり200平方メートル小規模住宅用地越えると一般住宅用地
      var area_general_residential = parseFloat($('#area_land').val()) - area_small_residential;
      if (parseFloat($('#purpose').val())) {
        if (area_small_residential >= $('#area_land').val()) {
          area_small_residential = $('#area_land').val();
          area_general_residential = 0;
          //console.log("residential");
        }
        else { area_general_residential = $('#area_land').val() - area_small_residential }
      }
      else {
        area_small_residential = 0;
        area_general_residential = 0;
        //console.log("notresidential");
      }
      //console.log("area_small_residential=" + area_small_residential + "area_general_residential=" + area_general_residential);
      unitprice_valuation_propertytax_land = parseFloat($('#valuation_propertytax_land').val()) / parseFloat($('#area_land').val());
      valuation_small_residential = unitprice_valuation_propertytax_land * area_small_residential;
      valuation_general_residential = unitprice_valuation_propertytax_land * area_general_residential;
      //console.log("valuation_small_residenntial=" + valuation_small_residential + "valuation_general_residential=" + valuation_general_residential + "unitprice_valuation_propertytax_land=" + unitprice_valuation_propertytax_land)
      amount_propertytax_land[0] = parseFloat(
        +(valuation_small_residential / 6 * 0.014)
        + (valuation_general_residential / 3 * 0.014)
        + (valuation_small_residential / 3 * 0.003)
        + (valuation_general_residential / 2 * 3 * 0.003)
      );
      $('#Amount_propertytax_land').val((amount_propertytax_land[0]).toFixed(2));
      //console.log("amount_propertytax_land=" + amount_propertytax_land[0]);
      return;
    };


    function AUTO_amount_propertytax_building() {
      ///建物
      amount_propertytax_building[0] = parseFloat($('#valuation_propertytax_building').val()) * 0.017
      $('#amount_propertytax_building').val((amount_propertytax_building[0]).toFixed(2));
      //console.log("small=" + valuation_small_residential + "general=" + valuation_general_residential + "propertytaxland=" + amount_propertytax_land[0] + "valuebuilding=" + valuation_propertytax_building[0] + " building=" + amount_propertytax_building[0]);
      return;
    };

    function PROPORTIONAL_CALCULATE() {
      //土地建物案分計算

      price_property = parseFloat($('#price_property').val());
      $('.price_property').val(price_property);
      valuation_propertytax_land[0] = parseFloat($('#valuation_propertytax_land').val());
      valuation_propertytax_building[0] = parseFloat($('#valuation_propertytax_building').val());
      land_rate = valuation_propertytax_land[0] / ((parseFloat(valuation_propertytax_land[0]) + parseFloat(valuation_propertytax_building[0])));//全体に対する土地の割合
      //land_rate = price_land[0] / ((price_land[0]) + price_building[0]);//全体に対する土地の割合
      if ($('.auto_price_land').prop("checked")) {
        price_land[0] = price_property * land_rate;//売買価格を固定資産税評価額で案分して仮に土地価格を計算
        land_rate = valuation_propertytax_land[0] / ((parseFloat(valuation_propertytax_land[0]) + parseFloat(valuation_propertytax_building[0])));//全体に対する土地の割合
        //console.log("price_land0_checked" + price_land[0]);
      }
      else {
        price_land[0] = parseFloat($('#price_land').val());
        land_rate = price_land[0] / ((price_land[0]) + price_building[0]);//全体に対する土地の割合
        //console.log("price_land0_notchecked" + price_land[0]);
      };
      price_building[0] = ((price_property - price_land[0]) / (1 + consumpiton_tax_rate));//売買金額から土地価格と消費税額を控除
      consumpiton_tax = ((price_building[0] * consumpiton_tax_rate));//消費税額の計算
      //console.log("1auto_price" + price_property + "land[0]" + price_land[0] + "#priceland=" + ($('#price_land').val()) + "price_building" + price_building[0] + "cotax=" + consumpiton_tax);
      price_land[0] = price_property - price_building[0] - consumpiton_tax;//端数は土地価格に寄せる
      //console.log("2auto_price" + price_property + "land[0]" + price_land[0] + "#priceland=" + ($('#price_land').val()) + "price_building" + price_building[0] + "cotax=" + consumpiton_tax);
      price_net[0] = price_land[0] + price_building[0];//正味物件価格
      //stamptax();
      AUTO_BROKERAGE_FEE();
      $('#depre_price').val(parseFloat(price_building[0] + consumpiton_tax + brokerage_fee_building).toFixed(2));
      $('#price_land').val(parseFloat(price_land[0]).toFixed(2));
      $('#price_building').val(parseFloat(price_building[0]).toFixed(2));
      $('#consumpiton_tax').val(parseFloat(consumpiton_tax).toFixed(2));
      //console.log("土地価格=" + price_land[0] + "建物価格＝" + price_building[0] + "消費税額=" + consumpiton_tax + "正味物件価格＝" + price_net[0]);
     // if(isNaN($('#depre_price').val()){$('#depre_price').val(0)};
     // if(isNaN($('#price_land').val()){$('#price_land').val(0)};
     // if(isNaN($('#price_building').val()){$('#price_building').val(0));
     // if(isNaN($('#consumpiton_tax').val()){$('#consumpiton_tax').val(0));
      return;
    }

    function AUTO_depre_amount() {
      PROPORTIONAL_CALCULATE();
      AUTO_BROKERAGE_FEE();
      var tmp_bldgrate = parseFloat((price_property - price_land[0]) / price_property);//減価償却対象割合
      var tmp_brokerage_fee = brokerage_fee * tmp_bldgrate;
      var tmp_depre = parseFloat(price_property - price_land[0] + tmp_brokerage_fee);
      //console.log("tmp_bldgrate=" + tmp_bldgrate + "tmp_brokerage_fee=" + tmp_brokerage_fee + "tmp_depre=" + tmp_depre + "depre_period=" + depre_period);
      $('#depre_price').val(tmp_depre);
      depre_price = tmp_depre;
      return depre_price;
    }

    function AUTO_BROKERAGE_FEE() {
      if ($('.auto_brokerage_fee').prop("checked")) {
        //仲介手数料自動計算
        //土地建物案分計算
        AUTO_valuation_propetytax();
        //AUTO_amount_propertytax_land();
        //AUTO_amount_propertytax_building();
        land_rate=price_land/price_property
        //仲介手数料の計算
        if (price_net[0] <= 200) brokerage_fee = price_net[0] * 0.05;
        if (price_net[0] <= 400) brokerage_fee = price_net[0] * 0.04 + 2;
        if (price_net[0] > 400) brokerage_fee = price_net[0] * 0.03 + 6;
        ////console.log("price_net=" + price_net[0] + "brokerage_feebt=" + brokerage_fee + "land=" + price_land[0] + "building=" + price_building[0]);
        brokerage_fee = parseFloat(brokerage_fee * (1 + 0.1));//消費税加算←消費税率の入力値は影響しない。
        brokerage_fee_land = brokerage_fee * land_rate;
        brokerage_fee_building = brokerage_fee - brokerage_fee_land;
        console.log("land_rate="+land_rate+"fee=" + brokerage_fee + "land=" + brokerage_fee_land + "building=" + brokerage_fee_building);
        $('#brokerage_fee_i,#brokerage_fee').val(brokerage_fee.toFixed(2));
        $('#brokerage_fee_building').val(brokerage_fee_building.toFixed(2));
        return;
      }
      else {
        brokerage_fee = parseFloat($('#brokerage_fee_i').val())
        brokerage_fee_land = brokerage_fee * land_rate;
        brokerage_fee_building = brokerage_fee - brokerage_fee_land;
        //console.log("fee=" + brokerage_fee + "land=" + brokerage_fee_land + "building=" + brokerage_fee_building);
        $('#brokerage_fee_i,#brokerage_fee').val(brokerage_fee.toFixed(2));
        $('#brokerage_fee_building').val(brokerage_fee_building.toFixed(2));
        return;
      }
    };

    function INSURANCE() {
      //火災保険・地震保険の計算
      tmp_insurance_amount = parseFloat(($('#insurance_amount')).val());
      tmp_insurance_amount = parseFloat(tmp_insurance_amount.toFixed(2))
      if ($("#auto_insurance_amount").prop("checked") == false) {
        insurance_amount = tmp_insurance_amount
      }
      else {
        insurance_amount = parseFloat($('#price_building').val())
      };

      //console.log("insuranceamount" + insurance_amount);
      if (insurance_amount <= 0) {
        insurance_amount = price_building[0];
      }
      var tmp_fire_base = construction_table[parseFloat($('#construction').val())][3];//火災保険基礎（火災保険の算定）
      var tmp_fire_plus = construction_table[parseFloat($('#construction').val())][4];//火災保険加算額（火災保険の算定）
      var tmp_fireproof = construction_table[parseFloat($('#construction').val())][6];//耐火性能（地震保険の算定）
      var tmp_buildingage = [$('#initial_years_since_construction').val()];//築年数加算用
      if (tmp_buildingage > 10) { tmp_buildingage = 10 };//築年数が１０年超えていれば１０年
      var tmp_prefectures = parseFloat($('#prefectures').val()) - 1;
      insurance_fire[0] = (insurance_amount / 1000 * (tmp_fire_base + (tmp_buildingage * tmp_fire_plus))) / 10000;//火災保険の計算。古くなるほど加算される
      insurance_earthquake[0] = insurance_amount / 2 / 1000 * earthquake_table[tmp_fireproof][tmp_prefectures];//地震保険の計算。耐火性能、都道府県、築年数による。火災保険の半分が保険対象
      //console.log("tmpf=" + tmp_prefectures + "保険加入額＝" + insurance_amount + "耐火性能＝" + tmp_fireproof + "火災保険料＝" + insurance_fire[0] + "地震保険料＝" + insurance_earthquake[0] + "保険経年加算＝" + tmp_fire_plus + "経年＝" + tmp_buildingage + "経年＝" + initial_years_since_construction + "都道府県番号＝" + tmp_prefectures);
      $('.insurance_fire').val((insurance_fire[0]).toFixed(2));
      $('.insurance_earthquake').val((insurance_earthquake[0]).toFixed(2));
      $('.insurance_total').val((insurance_fire[0] + insurance_earthquake[0]).toFixed(2));

      return;
    };

    function facility() {
      //エレベーターなどの設備
      opex_facility[0] = 0;
      $('.facility[type=checkbox]:checked').each(function () {
        opex_facility[0] += parseFloat($(this).val());
      });
      //console.log("facility=" + opex_facility[0]);
      $('#opex_facility').val((opex_facility[0].toFixed(2)));
      return opex_facility[0];
    }

    function water_electric() {
      if ($('#opex_water').val() >= 0) {
        opex_water_electric[0] = parseFloat($('#opex_water').val())
        return opex_water_electric[0]
      }
      else {
        opex_water_electric[0] = 0.05 * parseFloat($('#units').val()) * 12;
        //console.log("opex_water_electric[0]=" + opex_water_electric[0]);
        $('#opex_water').val((opex_water_electric[0]).toFixed(2));
        return opex_water_electric[0];
      }
    };
    function OPEX_ItoD() {
      //opexの計算
      var tmp_initial_rate_vacancy = $('#initial_rate_vacancy').val() / 100;
      var tmp_gpi = parseFloat($('#gpi').val())
      var tmp_units = parseFloat($('#units').val());
      egi[0] = parseFloat($('#gpi').val()) * (1 - tmp_initial_rate_vacancy);
      if ($('#opex_rental_management_amount').val() == "") {
        opex_rental_management_amount[0] = egi[0] * $('#opex_rental_management').val() / 100
      };
      if ($('#opex_building_management_amount').val() == "") {
        opex_building_management_amount[0] = construction_table[parseFloat($('#construction').val())][7] * tmp_units
      };

      //opex_rental_management_amount[0]=egi[0]*$('#opex_rental_management').val()/100;//賃貸管理費
      if ($('#opex_facility').val() == "") {
        opex_facility[0] = facility();
      };

      opex_other[0] = parseFloat($('#opex_other').val());
      
     //原状回復費が自動計算値と違っていたら自動計算しない
      var tmp_opex_recoverycost=egi[0] / 12 * parseFloat($('#recovery_cost_month').val()) / ((parseFloat(($('#occupancy_period').val())) / 12));
      if (opex_recoverycost[0] == tmp_opex_recoverycost){
          opex_recoverycost[0]=tmp_opex_recoverycost
        }
     //募集費用が自動計算値と違っていたら自動計算しない
      var tmp_opex_recruitmentcost= egi[0] / 12 * parseFloat($('#recruitment_cost_month').val()) / ((parseFloat(($('#occupancy_period').val())) / 12));
      if(opex_recruitmentcost[0] ==tmp_opex_recruitmentcost){
        opex_recruitmentcost[0]=tmp_opex_recruitmentcost
      }

      opex_water_electric[0] = water_electric();
      //console.log("facility=" + opex_facility[0] + "water=" + opex_water_electric[0]);
      //INSURANCE();
      opex[0] = insurance_fire[0] + insurance_earthquake[0] + opex_rental_management_amount[0] + opex_building_management_amount[0] + opex_recruitmentcost[0] + opex_recoverycost[0] + opex_facility[0] + opex_water_electric[0] + amount_propertytax_building[0] + amount_propertytax_land[0] + opex_other[0];

      //console.log("opex_total  inf=" + insurance_fire[0] + "ine=" + insurance_earthquake[0] + "orm=" + opex_rental_management_amount[0] + "obm=" + opex_building_management_amount[0] + "rc=" + opex_recruitmentcost[0] + "recc=" + opex_recoverycost[0] + "faci=" + opex_facility[0] + "we=" + opex_water_electric[0] + "pb=" + amount_propertytax_building[0] + "pt=" + amount_propertytax_land[0] + "oo=" + opex_other[0])

      opex_rate = opex[0] / egi[0];

      //console.log("egi=" + egi[0] + "募集費用＝" + opex_recruitmentcost[0] + "原状回復費用＝" + opex_recoverycost[0] + "opex=" + opex[0] + "opexrate=" + opex_rate);

      $('#opex_rental_management_amount').val((opex_rental_management_amount[0]).toFixed(2));
      $('#opex_building_management_amount').val((opex_building_management_amount[0]).toFixed(2));
      $('#Opex_recoverycost').val((opex_recoverycost[0]).toFixed(2));
      $('#opex_recruitmentcost').val((opex_recruitmentcost[0]).toFixed(2));
      $('#opex_facility').val((opex_facility[0].toFixed(2)));

      $('#Opex_sum').val(opex[0].toFixed(2));
      $('#Opex_total_rate').val(((opex[0] / egi[0]) * 100).toFixed(2));


      //console.log("opex_rate=" + $('#Opex_total_rate').val() + "opex_ratec=" + opex_rate + "egi=" + egi[0])
      //console.log("opex_total fire " + insurance_fire[0] + "eq" + insurance_earthquake[0] + "rm" + opex_rental_management_amount[0] + "bm" + opex_building_management_amount[0]);
      //console.log("rec=" + opex_recruitmentcost[0] + "recv=" + opex_recoverycost[0] + "fac=" + opex_facility[0] * "water=" + opex_water_electric[0] + "pbu=" + amount_propertytax_building[0] + "pl=" + amount_propertytax_land[0] + "other=" + opex_other[0]);
      //console.log("opexsum=" + opex_sum + "opex[0]" + opex[0]);
      return;
    };

    //データ読み込み

    var tmp_file;
    var tmp_file_array;
    let fileInput = document.getElementById('file');
    let fileReader = new FileReader();
    fileInput.onchange = () => {
      let file = fileInput.files[0];
      fileReader.readAsText(file);
    };
    fileReader.onload = function () {
      tmp_file = fileReader.result;
      tmp_file_array = tmp_file.split('=');
      tmp_file_array = tmp_file_array[1].split(',');
      //console.log("length=" + tmp_file_array.length + "file=" + tmp_file_array);
      DATA_LOAD(tmp_file_array);
    };
    function DATA_LOAD() {

      $('#name_property').val(tmp_file_array[0]);
      $('#prefectures').val(tmp_file_array[1]);
      $('#address_property').val(tmp_file_array[2]);
      $('#price_property').val(tmp_file_array[3]);
      $('#area_land').val(tmp_file_array[4]);
      $('#area_building').val(tmp_file_array[5]);

      $('#initial_years_since_construction').val(tmp_file_array[6]);
      $('#construction').val(tmp_file_array[7]);
      $('#road_price').val(tmp_file_array[8]);
      $('#leasehold').val(tmp_file_array[9]);
      $('#inheritance_special_area').val(tmp_file_array[10]);
      $('#purpose').val(tmp_file_array[11]);
      $('#rate_pluscap').val(tmp_file_array[12]);
      $('#valuation_propertytax_land').val(tmp_file_array[13]);
      $('#valuation_propertytax_building').val(tmp_file_array[14]);
      $('#price_land').val(tmp_file_array[15]);
      $('#price_building').val(tmp_file_array[16]);
      $('#consumpiton_tax').val(tmp_file_array[17]);
      $('#brokerage_fee_building').val(tmp_file_array[18]);
      $('#depre_price').val(tmp_file_array[19]);
      $('#insurance_amount').val(tmp_file_array[20]);
      $('#loan_amount').val(tmp_file_array[21]);
      $('#loan_period').val(tmp_file_array[22]);
      $('#loan_rate').val(tmp_file_array[23]);
      $('#ads').val(tmp_file_array[24]);
      $('#units').val(tmp_file_array[25]);
      $('#gpi_room_month').val(tmp_file_array[26]);
      $('#gpi').val(tmp_file_array[27]);
      $('#occupancy_period').val(tmp_file_array[28]);
      $('#recruitment_period').val(tmp_file_array[29]);
      $('#initial_rate_vacancy').val(tmp_file_array[30]);
      $('#recruitment_cost_month').val(tmp_file_array[31]);
      $('#recovery_cost_month').val(tmp_file_array[32]);
      $('#opex_rental_management').val(tmp_file_array[33]);

      if (tmp_file_array[34] == "true") { $('#d_rb1').prop('checked', true) };
      if (tmp_file_array[35] == "true") { $('#d_rb2').prop('checked', true) };
      if (tmp_file_array[36] == "true") { $('#d_rb3').prop('checked', true) };
      if (tmp_file_array[37] == "true") { $('#d_rb4').prop('checked', true) };
      if (tmp_file_array[38] == "true") { $('#d_rb5').prop('checked', true) };
      if (tmp_file_array[39] == "true") { $('#d_rb6').prop('checked', true) };


      $('#shisan').val(tmp_file_array[40]);
      $('#haigu').val(tmp_file_array[41]);
      $('#kodomo').val(tmp_file_array[42]);
      $('#souzokuzei,.souzokuzei').val(tmp_file_array[43]);
      $('#PorC').val(tmp_file_array[44]);
      $('#rate_income_tax').val(tmp_file_array[45]);
      $('#analysis_start_year').val(tmp_file_array[46]);
      $('#analysis_period').val(tmp_file_array[47]);
      $('#initial_year').val(tmp_file_array[48]);
      $('#initial_ownerage').val(tmp_file_array[49]);
      $('#discount_rate').val(tmp_file_array[50]);
      $('#rate_sale').val(tmp_file_array[51]);
      $('#rate_pluscap').val(tmp_file_array[52]);
      $('#consumpiton_tax_rate').val(tmp_file_array[53]);
      $('#rate_cumlative').val(tmp_file_array[54]);
      $('#registrationtax_transfer').val(tmp_file_array[55]);
      $('#registrationtax_mortgage').val(tmp_file_array[56]);
      $('#acquisitiontax_land').val(tmp_file_array[57]);
      $('#acquisitiontax_building').val(tmp_file_array[58]);
      $('#brokerage_fee_i').val(tmp_file_array[59]);
      $('#legal_fee').val(tmp_file_array[60]);
      $('#bank_fee').val(tmp_file_array[61]);
      $('#Stamptax_transfer').val(tmp_file_array[62]);
      $('#stamptax_loan').val(tmp_file_array[63]);
      $('#other_fee').val(tmp_file_array[64]);
      $('#initial_cost').val(tmp_file_array[65]);
      $('#initial_totalcost').val(tmp_file_array[66]);
      $('#Amount_propertytax_land').val(tmp_file_array[67]);
      $('#amount_propertytax_building').val(tmp_file_array[68]);
      $('#insurance_fire').val(tmp_file_array[69]);
      $('#insurance_earthquake').val(tmp_file_array[70]);
      $('#opex_rental_management_amount').val(tmp_file_array[71]);
      $('#opex_building_management_amount').val(tmp_file_array[72]);
      $('#opex_facility').val(tmp_file_array[73]);
      $('#opex_water').val(tmp_file_array[74]);
      $('#opex_recruitmentcost').val(tmp_file_array[75]);
      $('#Opex_recoverycost').val(tmp_file_array[76]);
      $('#opex_other').val(tmp_file_array[77]);
      $('#Opex_sum').val(tmp_file_array[78]);
      $('#Opex_total_rate').val(tmp_file_array[79]);
      $('#valuation_inheritance_building').val(tmp_file_array[80]);
      $('#special_area_amount').val(tmp_file_array[81]);
      $('#valuation_inheritance_land').val(tmp_file_array[82]);
      $('#valuation_inheritance_property').val(tmp_file_array[83]);
      $('#initial_totalcost').val(tmp_file_array[84]);
      $('#valuation_inheritance_compression').val(tmp_file_array[85]);
      $('#after_souzokuzei').val(tmp_file_array[86]);
      if (tmp_file_array[87] == "true") { $('#auto_valuation_propertytax_land').prop('checked', true) };
      if (tmp_file_array[88] == "true") { $('#auto_valuation_propertytax_building').prop('checked', true) };
      if (tmp_file_array[89] == "true") { $('.auto_price_land').prop('checked', true) };
      if (tmp_file_array[90] == "true") { $('#auto_insurance_amount').prop('checked', true) };
      $('#kpc').val(tmp_file_array[91]);
      $('#comment').val(tmp_file_array[92]);
      $('#Youtube').val(tmp_file_array[93]);
      $('#shisan_cash').val(tmp_file_array[94]);
      $('#url_rosenka').val(tmp_file_array[95]);
      $('#url_property').val(tmp_file_array[96]);
      $('#rate_rent_decline1').val(tmp_file_array[97]);
      $('#rate_rent_decline2').val(tmp_file_array[98]);
      $('#rate_rent_decline3').val(tmp_file_array[99]);
      $('#rate_rent_decline4').val(tmp_file_array[100]);
      $('#rate_rent_decline5').val(tmp_file_array[101]);
      if (tmp_file_array[102] == "false") { $('.auto_brokerage_fee').prop('checked', false) };

      //console.log("shisan=" + tmp_file_array[40] + "haigu=" + tmp_file_array[41]);
      //console.log("stamptax_transfer=" + tmp_file_array[62] + "stamptax_loan=" + tmp_file_array[63])
      INHERITANCE();
      stamptax();
      MAIN();
      CALC();
      INITIAL();//追加
      INITIAL_COST_CAL();
      GRAPH_DRAW();
      SHEET_DRAW();
      initMap();
      movie();




    }


    function DATA_SAVE() {

      var sv_name_property = $('#name_property').val();
      var sv_prefectures = $('#prefectures').val();
      var sv_address_property = $('#address_property').val();
      var sv_price_property = $('#price_property').val();
      var sv_area_land = $('#area_land').val();
      var sv_area_building = $('#area_building').val();
      var sv_initial_years_since_construction = $('#initial_years_since_construction').val();
      var sv_construction = $('#construction').val();
      var sv_road_price = $('#road_price').val();
      var sv_leasehold = $('#leasehold').val();
      var sv_inheritance_special_area = $('#inheritance_special_area').val();
      var sv_purpose = $('#purpose').val();
      var sv_rate_pluscap = $('#rate_pluscap').val();
      var sv_valuation_propertytax_land = $('#valuation_propertytax_land').val();
      var sv_valuation_propertytax_building = $('#valuation_propertytax_building').val();
      var sv_price_land = $('#price_land').val();
      var sv_price_building = $('#price_building').val();
      var sv_consumpiton_tax = $('#consumpiton_tax').val();
      var sv_brokerage_fee_building = $('#brokerage_fee_building').val();
      var sv_depre_price = $('#depre_price').val();
      var sv_insurance_amount = $('#insurance_amount').val();
      var sv_loan_amount = $('#loan_amount').val();
      var sv_loan_period = $('#loan_period').val();
      var sv_loan_rate = $('#loan_rate').val();
      var sv_ads = $('#ads').val();
      var sv_units = $('#units').val();
      var sv_gpi_room_month = $('#gpi_room_month').val();
      var sv_gpi = $('#gpi').val();
      var sv_occupancy_period = $('#occupancy_period').val();
      var sv_recruitment_period = $('#recruitment_period').val();
      var sv_initial_rate_vacancy = $('#initial_rate_vacancy').val();
      var sv_recruitment_cost_month = $('#recruitment_cost_month').val();
      var sv_recovery_cost_month = $('#recovery_cost_month').val();
      var sv_opex_rental_management = $('#opex_rental_management').val();
      var sv_elv = $('#d_rb1').prop('checked');
      var sv_watertank = $('#d_rb2').prop('checked');
      var sv_catv = $('#d_rb3').prop('checked');
      var sv_intnet = $('#d_rb4').prop('checked');
      var sv_tree = $('#d_rb5').prop('checked');
      var sv_highv = $('#d_rb6').prop('checked');
      //console.log("elv" + sv_elv + sv_watertank + sv_catv + sv_intnet + sv_tree + sv_highv)
      var sv_shisan = $('#shisan').val();
      var sv_haigu = $('#haigu').val();
      var sv_kodomo = $('#kodomo').val();
      var sv_souzokuzei = $('#souzokuzei').val();
      var sv_PorC = $('#PorC').val();
      var sv_rate_income_tax = $('#rate_income_tax').val();
      var sv_analysis_start_year = ($('#analysis_start_year').val());
      var sv_analysis_period = ($('#analysis_period').val());
      var sv_initial_year = ($('#initial_year').val());
      var sv_initial_ownerage = ($('#initial_ownerage').val());
      var sv_discount_rate = ($('#discount_rate').val());
      var sv_rate_sale = ($('#rate_sale').val());
      var sv_rate_pluscap = [($('#rate_pluscap').val())];
      var sv_consumpiton_tax_rate = $('#consumpiton_tax_rate').val();
      var sv_rate_cumlative = $('#rate_cumlative').val();

      var sv_registrationtax_transfer = $('#registrationtax_transfer').val();
      var sv_registrationtax_mortgage = $('#registrationtax_mortgage').val();
      var sv_acquisitiontax_land = $('#acquisitiontax_land').val();
      var sv_acquisitiontax_building = $('#acquisitiontax_building').val();
      var sv_brokerage_fee_i = $('#brokerage_fee_i').val();
      var sv_legal_fee = $('#legal_fee').val();
      var sv_bank_fee = $('#bank_fee').val();
      var sv_stamptax_transfer = $('#Stamptax_transfer').val();
      var sv_stamptax_loan = $('#stamptax_loan').val();
      var sv_other_fee = $('#other_fee').val();
      var sv_initial_cost = $('#initial_cost').val();
      var sv_initial_totalcost = $('#initial_totalcost').val();
      var sv_amount_propertytax_land = $('#Amount_propertytax_land').val();
      var sv_amount_propertytax_building = $('#amount_propertytax_building').val();
      var sv_insurance_fire = $('#insurance_fire').val();
      var sv_insurance_earthquake = $('#insurance_earthquake').val();
      var sv_opex_rental_management_amount = $('#opex_rental_management_amount').val();
      var sv_opex_building_management_amount = $('#opex_building_management_amount').val();
      var sv_opex_facility = $('#opex_facility').val();
      var sv_opex_water = $('#opex_water').val();
      var sv_opex_recruitmentcost = $('#opex_recruitmentcost').val();
      var sv_opex_recoverycost = $('#Opex_recoverycost').val();
      var sv_opex_other = $('#opex_other').val();
      var sv_opex_sum = $('#Opex_sum').val();
      var sv_opex_total_rate = $('#Opex_total_rate').val();
      var sv_valuation_inheritance_building = $('#valuation_inheritance_building').val();
      var sv_special_area_amount = $('#special_area_amount').val();
      var sv_valuation_inheritance_land = $('#valuation_inheritance_land').val();
      var sv_valuation_inheritance_property = $('#valuation_inheritance_property').val();
      var sv_initial_totalcost = $('#initial_totalcost').val();
      var sv_valuation_inheritance_compression = $('#valuation_inheritance_compression').val();
      var sv_after_souzokuzei = $('#after_souzokuzei').val();
      var sv_auto_valuation_propertytax_land = $('#auto_valuation_propertytax_land').prop('checked');
      var sv_auto_valuation_propertytax_building = $('#auto_valuation_propertytax_building').prop('checked');
      var sv_auto_price_land = $('.auto_price_land').prop('checked');
      var sv_auto_insurance_amount = $('#auto_insurance_amount').prop('checked');
      var sv_kpc = $('#kpc').val();
      var sv_comment = $('#comment').val();
      var sv_youtube = $('#Youtube').val();
      var sv_shisan_cash = $('#shisan_cash').val();
      var sv_url_rosenka = $('#url_rosenka').val();
      var sv_url_property = $('#url_property').val();
      var sv_rate_rent_decline1 = $('#rate_rent_decline1').val();
      var sv_rate_rent_decline2 = $('#rate_rent_decline2').val();
      var sv_rate_rent_decline3 = $('#rate_rent_decline3').val();
      var sv_rate_rent_decline4 = $('#rate_rent_decline4').val();
      var sv_rate_rent_decline5 = $('#rate_rent_decline5').val();
      var sv_auto_brokerage_fee=$('.auto_brokerage_fee').prop('checked');


      //console.log("roadprice=" + road_price);

      var savedata =
        sv_name_property
        + "," + sv_prefectures
        + "," + sv_address_property
        + "," + sv_price_property
        + "," + sv_area_land
        + "," + sv_area_building
        + "," + sv_initial_years_since_construction
        + "," + sv_construction
        + "," + sv_road_price
        + "," + sv_leasehold
        + "," + sv_inheritance_special_area
        + "," + sv_purpose
        + "," + sv_rate_pluscap
        + "," + sv_valuation_propertytax_land
        + "," + sv_valuation_propertytax_building
        + "," + sv_price_land
        + "," + sv_price_building
        + "," + sv_consumpiton_tax
        + "," + sv_brokerage_fee_building
        + "," + sv_depre_price
        + "," + sv_insurance_amount
        + "," + sv_loan_amount
        + "," + sv_loan_period
        + "," + sv_loan_rate
        + "," + sv_ads
        + "," + sv_units
        + "," + sv_gpi_room_month
        + "," + sv_gpi
        + "," + sv_occupancy_period
        + "," + sv_recruitment_period
        + "," + sv_initial_rate_vacancy
        + "," + sv_recruitment_cost_month
        + "," + sv_recovery_cost_month
        + "," + sv_opex_rental_management
        + "," + sv_elv
        + "," + sv_watertank
        + "," + sv_catv
        + "," + sv_intnet
        + "," + sv_tree
        + "," + sv_highv
        + "," + sv_shisan
        + "," + sv_haigu
        + "," + sv_kodomo
        + "," + sv_souzokuzei
        + "," + sv_PorC
        + "," + sv_rate_income_tax
        + "," + sv_analysis_start_year
        + "," + sv_analysis_period
        + "," + sv_initial_year
        + "," + sv_initial_ownerage
        + "," + sv_discount_rate
        + "," + sv_rate_sale
        + "," + sv_rate_pluscap
        + "," + sv_consumpiton_tax_rate
        + "," + sv_rate_cumlative
        + "," + sv_registrationtax_transfer
        + "," + sv_registrationtax_mortgage
        + "," + sv_acquisitiontax_land
        + "," + sv_acquisitiontax_building
        + "," + sv_brokerage_fee_i
        + "," + sv_legal_fee
        + "," + sv_bank_fee
        + "," + sv_stamptax_transfer
        + "," + sv_stamptax_loan
        + "," + sv_other_fee
        + "," + sv_initial_cost
        + "," + sv_initial_totalcost
        + "," + sv_amount_propertytax_land
        + "," + sv_amount_propertytax_building
        + "," + sv_insurance_fire
        + "," + sv_insurance_earthquake
        + "," + sv_opex_rental_management_amount
        + "," + sv_opex_building_management_amount
        + "," + sv_opex_facility
        + "," + sv_opex_water
        + "," + sv_opex_recruitmentcost
        + "," + sv_opex_recoverycost
        + "," + sv_opex_other
        + "," + sv_opex_sum
        + "," + sv_opex_total_rate
        + "," + sv_valuation_propertytax_building
        + "," + sv_special_area_amount
        + "," + sv_valuation_inheritance_land
        + "," + sv_valuation_inheritance_property
        + "," + sv_initial_totalcost
        + "," + sv_valuation_inheritance_compression
        + "," + sv_after_souzokuzei
        + "," + sv_auto_valuation_propertytax_land
        + "," + sv_auto_valuation_propertytax_building
        + "," + sv_auto_price_land
        + "," + sv_auto_insurance_amount
        + "," + sv_kpc
        + "," + sv_comment
        + "," + sv_youtube
        + "," + sv_shisan_cash
        + "," + sv_url_rosenka
        + "," + sv_url_property
        + "," + sv_rate_rent_decline1
        + "," + sv_rate_rent_decline2
        + "," + sv_rate_rent_decline3
        + "," + sv_rate_rent_decline4
        + "," + sv_rate_rent_decline5
        + "," + sv_auto_brokerage_fee


      //console.log(savedata);


      //パラメータを取得
      prm = decodeURIComponent(savedata);
      //$('a.linkA').attr("href", "( 遷移先URL )" + prm);
      $('a.linkA').attr("href", "https://souzoku-tool.club/kamakan.html?" + prm);



      return savedata;




    };

    function handleDownload() {
      var content = DATA_SAVE();
      var bom = new Uint8Array([0xEF, 0xBB, 0xBF]);
      var blob = new Blob([bom, content], { "type": "text/csv" });
      var filename = $('#name_property').val() + ".csv";
      $('#download').attr('download', filename);
      //console.log("filename=", filename);


      if (window.navigator.msSaveBlob) {
        window.navigator.msSaveBlob(blob, filename);

        // msSaveOrOpenBlobの場合はファイルを保存せずに開ける
        window.navigator.msSaveOrOpenBlob(blob, filename);
      } else {
        document.getElementById("download").href = window.URL.createObjectURL(blob);
      }
    }

    function linkDownload() {
      var content = "https://souzoku-tool.club/kamakan.html?=" + DATA_SAVE();
      var bom = new Uint8Array([0xEF, 0xBB, 0xBF]);
      var blob = new Blob([bom, content], { "type": "text/csv" });
      var linkfilename = $('#name_property').val() + ".csv";

      var gQR = "https://chart.apis.google.com/chart?cht=qr&chs=350x350&chl=" + content
      $('#googleQR').attr("src", gQR)
      $('#link_download').attr('download', linkfilename);
      //console.log("linkfilename=", linkfilename);
      if (window.navigator.msSaveBlob) {
        window.navigator.msSaveBlob(blob, linkfilename);

        // msSaveOrOpenBlobの場合はファイルを保存せずに開ける
        window.navigator.msSaveOrOpenBlob(blob, linkfilename);
      } else {
        document.getElementById("link_download").href = window.URL.createObjectURL(blob);
      }



    }

    function makeQR() {
      var content = "https://souzoku-tool.club/kamakan.html?=" + DATA_SAVE();
      var gQR = "https://chart.apis.google.com/chart?cht=qr&chs=350x350&chl=" + content
      $('#googleQR').attr("src", gQR)

    }


    $('#savedata').click(function () {
      if (($('#name_property').val()) == "") { alert("物件名を入力してください") }
      else {
        var content = DATA_SAVE();
        var link = document.createElement('a');
        link.href = window.URL.createObjectURL(new Blob([content]));
        link.download = $('#name_property').val() + ".csv";
        link.click()
      };
    });




    function stamptax() {
      //印紙税の計算
      ///売買契約書
      if (price_net[0] > 500000) { stamptax_transfer = 48 };
      if (price_net[0] <= 500000) { stamptax_transfer = 32 };
      if (price_net[0] <= 100000) { stamptax_transfer = 16 };
      if (price_net[0] <= 50000) { stamptax_transfer = 6 };
      if (price_net[0] <= 10000) { stamptax_transfer = 3 };
      if (price_net[0] <= 5000) { stamptax_transfer = 1 };
      if (price_net[0] <= 1000) stamptax_transfer = 0.5;
      if (price_net[0] <= 500) stamptax_transfer = 0.1;
      if (price_net[0] <= 100) stamptax_transfer = 0.05;
      if (price_net[0] <= 50) stamptax_transfer = 0.02;
      if (price_net[0] <= 10) stamptax_transfer = 0.02;
      if (price_net[0] <= 1) stamptax_transfer = 0;
      ///金銭消費貸借契約
      loan_amount = parseFloat($('#loan_amount').val());
      if (loan_amount > 500000) { stamptax_loan = 60 };
      if (loan_amount <= 500000) { stamptax_loan = 40 };
      if (loan_amount <= 100000) { stamptax_loan = 20 };
      if (loan_amount <= 50000) { stamptax_loan = 10 };
      if (loan_amount <= 10000) { stamptax_loan = 6 };
      if (loan_amount <= 5000) { stamptax_loan = 2 };
      if (loan_amount <= 1000) stamptax_loan = 1;
      if (loan_amount <= 500) stamptax_loan = 0.2;
      if (loan_amount <= 100) stamptax_loan = 0.1;
      if (loan_amount <= 50) stamptax_loan = 0.04;
      if (loan_amount <= 10) stamptax_loan = 0.02;
      if (loan_amount <= 1) stamptax_loan = 0;
      ///建築請負契約
      if (price_building[0] > 500000) { stamptax_arc = 48 };
      if (price_building[0] <= 500000) { stamptax_arc = 32 };
      if (price_building[0] <= 100000) { stamptax_arc = 16 };
      if (price_building[0] <= 50000) { stamptax_arc = 6 };
      if (price_building[0] <= 10000) { stamptax_arc = 3 };
      if (price_building[0] <= 5000) { stamptax_arc = 1 };
      if (price_building[0] <= 1000) stamptax_arc = 0.5;
      if (price_building[0] <= 500) stamptax_arc = 0.1;
      if (price_building[0] <= 300) stamptax_arc = 0.05;
      if (price_building[0] <= 200) stamptax_arc = 0.02;
      if (price_building[0] <= 10) stamptax_arc = 0.02;
      if (price_building[0] <= 1) stamptax_arc = 0;

      $('#Stamptax_transfer').val(stamptax_transfer);//+stamptax_arc);とりあえず建築は保留

      $('#stamptax_loan').val(stamptax_loan);


      return;
    };

    ////console.log("price_net="+price_net[0]+"stamptax_transfer="+stamptax_transfer+"stamptax_arc="+stamptax_arc+"stamptax_loan="+stamptax_loan);



    function INHERITANCE() {
      var tmp_road_price = parseFloat($('#road_price').val())
      var tmp_area_land = parseFloat($('#area_land').val())
      var tmp_leasehold = (1 - (parseFloat($('#leasehold').val()) * 0.003))
      var tmp_inheritance_special_area = parseFloat($('#inheritance_special_area').val());
      shisan = parseFloat(($('#shisan')).val());
      $('.shisan').val(shisan.toFixed(0));
      inheritance_amount[0] = Souzokuzeikeisan(shisan);
      //相続税評価額の計算
      valuation_inheritance_building = [];
      valuation_inheritance_property = [];
      valuation_inheritance_land[0] = tmp_road_price * tmp_area_land * tmp_leasehold / 10;
      //if(price_land == 0){valuation_inheritance_land[0] = 0}//入力土地価格がゼロならば、自己所有地への建築として相続税評価もゼロに
      build_style()

      var tmp_special_area_amount = valuation_inheritance_land[0] / tmp_area_land * tmp_inheritance_special_area * 0.5;
      $('#souzokuzei,.souzokuzei').val(inheritance_amount[0].toFixed(0));
      $('#special_area_amount').val(tmp_special_area_amount.toFixed(0));
      valuation_inheritance_land[0] = valuation_inheritance_land[0] - tmp_special_area_amount;
      valuation_inheritance_building[0] = valuation_propertytax_building[0] * (1 - 0.3 * (($('#leasehold').val()) > 0));//借地権割合がゼロでなければ、建物固定資産税評価額を70%

      var tmp_after_inheritance_value = shisan + valuation_inheritance_land[0] + valuation_inheritance_building[0] - initial_totalcost;
      var tmp_after_inheritance_amount = Souzokuzeikeisan(tmp_after_inheritance_value)

      $('#valuation_inheritance_land').val(valuation_inheritance_land[0].toFixed(0));
      $('#valuation_inheritance_building').val(valuation_inheritance_building[0].toFixed(0));
      $('#valuation_inheritance_property').val((valuation_inheritance_building[0] + valuation_inheritance_land[0]).toFixed(0));
      $('#valuation_inheritance_compression').val((initial_totalcost - valuation_inheritance_building[0] - valuation_inheritance_land[0]).toFixed(0));
      $('#valuation_inheritance_after').val(tmp_after_inheritance_value.toFixed(0));
      $('#after_souzokuzei').val(tmp_after_inheritance_amount.toFixed(0));
      $('#amount_inheritance_compression').val((inheritance_amount[0] - tmp_after_inheritance_amount).toFixed(0));

      //$('#after_souzokuzei').val(inheritance_amount[1].toFixed(2));

      return;//追加


    };//INHERITANCE()

    function REGISTRATIONTAX_ACQUISITIONTAX() {
      //登録免許税の計算
      loan_amount = parseFloat($('#loan_amount').val());
      valuation_propertytax_land[0] = parseFloat($('#valuation_propertytax_land').val());
      valuation_propertytax_building[0] = parseFloat($('#valuation_propertytax_building').val());
      registrationtax_mortgage = loan_amount * 0.004;//抵当権設定
      //if(price_land == 0)
      // {registrationtax_transfer = valuation_propertytax_building[0] * 0.02}
      //else
      // {registrationtax_transfer = (valuation_propertytax_land[0] * 0.015) + (valuation_propertytax_building[0] * 0.02);}
      $('#registrationtax_transfer').val((registrationtax_transfer).toFixed(2));
      $('#registrationtax_mortgage').val((registrationtax_mortgage).toFixed(2));
      //console.log("valuation_propertytax_land=" + valuation_propertytax_land[0] + "valuation_propertytax_building=" + valuation_propertytax_building[0]);
      //console.log("registrationtax_mortgage=" + registrationtax_mortgage + "registrationtax_transfer=" + registrationtax_transfer);
      //不動産取得税の計算→打込土地価格が０の場合、所有地上への建築として土地取得税はゼロに
      acquisitiontax_land = valuation_propertytax_land * 0.015;
      if(price_land==0){
        acquisitiontax_land = 0}
  

      if (parseFloat($('#purpose').val())) {
        acquisitiontax_building = valuation_propertytax_building * 0.03
      }
      else {
        acquisitiontax_building = valuation_propertytax_building * 0.04
      };
      $('#acquisitiontax_land').val((acquisitiontax_land).toFixed(2));
      $('#acquisitiontax_building').val((acquisitiontax_building).toFixed(2));
      return;
    };//registrationtax_acquisitiontax

    function BANK_CALC() {
      //銀行評価の計算
      bank_building = [];
      bank_land = [];
      bank_total = [];
      bank_land[0] = ((parseFloat($('#road_price').val()) * parseFloat($('#area_land').val())) / 10) / ((parseFloat($('#rate_cumlative').val()) * 0.01));
      //console.log("rate_cumlative=" + parseFloat($('#rate_cumlative').val()));
      if (construction_table[parseFloat($('#construction').val())][0] <= $('#initial_years_since_construction').val()) {
        var tmp = 0;

      }
      else {
        var tmp = construction_table[parseFloat($('#construction').val())][0] - $('#initial_years_since_construction').val()
      };
      bank_building[0] = parseFloat($('#area_building').val()) * construction_table[parseFloat($('#construction').val())][2] / 10000 * tmp / construction_table[parseFloat($('#construction').val())][0];
      return;
    };

    /*
    function initial_total(){
    
    //初期費用合計額の計算
    initial_cost=parseFloat(stamptax_loan)+parseFloat(stamptax_transfer)+parseFloat(brokerage_fee+insurance_fire[0])+insurance_earthquake[0]+registrationtax_transfer+registrationtax_mortgage+acquisitiontax_land+acquisitiontax_building+parseFloat(legal_fee)+parseFloat(bank_fee);
    initial_totalcost=parseFloat(price_property)+initial_cost;
    
    //console.log("initial_totalcost="+initial_totalcost+"initial_cost="+initial_cost);
    //console.log("initial_cost=="+stamptax_loan+stamptax_transfer+brokerage_fee+insurance_fire[0]+insurance_earthquake[0]+registrationtax_transfer+registrationtax_mortgage+acquisitiontax_land+acquisitiontax_building+legal_fee+bank_fee);
    $('.initial_totalcost').val((initial_totalcost).toFixed(2));
    $('#initial_cost').val((initial_cost).toFixed(2));
    
    };
    */

    function DATA_DtoG() {
      name_property = $('#name_property').val();
      prefectures = $('#prefectures').val();
      address_property = $('#address_property').val();
      price_property = $('#price_property').val();
      area_land = $('#area_land').val();
      area_building = $('#area_building').val();
      initial_years_since_construction = $('#initial_years_since_construction').val();
      construction = $('#construction').val();
      road_price = $('#road_price').val();
      leasehold = $('#leasehold').val();
      inheritance_special_area = $('#inheritance_special_area').val();
      purpose = $('#purpose').val();
      rate_pluscap = $('#rate_pluscap').val();
      valuation_propertytax_land = $('#valuation_propertytax_land').val();
      valuation_propertytax_building = $('#valuation_propertytax_building').val();
      price_land = $('#price_land').val();
      price_building = $('#price_building').val();
      consumpiton_tax = $('#consumpiton_tax').val();
      brokerage_fee_building = $('#brokerage_fee_building').val();
      depre_price = $('#depre_price').val();
      insurance_amount = $('#insurance_amount').val();
      loan_amount = $('#loan_amount').val();
      loan_period = $('#loan_period').val();
      loan_rate = $('#loan_rate').val();
      ads = $('#ads').val();
      units = $('#units').val();
      gpi_room_month = $('#gpi_room_month').val();
      gpi = $('#gpi').val();
      occupancy_period = $('#occupancy_period').val();
      recruitment_period = $('#recruitment_period').val();
      initial_rate_vacancy = $('#initial_rate_vacancy').val();
      recruitment_cost_month = $('#recruitment_cost_month').val();
      recovery_cost_month = $('#recovery_cost_month').val();
      opex_rental_management = $('#opex_rental_management').val();
      elv = $('#d_rb1').prop('checked');
      watertank = $('#d_rb2').prop('checked');
      catv = $('#d_rb3').prop('checked');
      intnet = $('#d_rb4').prop('checked');
      tree = $('#d_rb5').prop('checked');
      highv = $('#d_rb6').prop('checked');
      //console.log("elv" + sv_elv + sv_watertank + sv_catv + sv_intnet + sv_tree + sv_highv)
      shisan = $('#shisan').val();
      haigu = $('#haigu').val();
      kodomo = $('#kodomo').val();
      souzokuzei = $('#souzokuzei').val();
      PorC = $('#PorC').val();
      rate_income_tax = $('#rate_income_tax').val();
      analysis_start_year = ($('#analysis_start_year').val());
      analysis_period = ($('#analysis_period').val());
      initial_year = ($('#initial_year').val());
      initial_ownerage = ($('#initial_ownerage').val());
      discount_rate = ($('#discount_rate').val());
      rate_sale = ($('#rate_sale').val());
      rate_pluscap = [($('#rate_pluscap').val())];
      consumpiton_tax_rate = $('#consumpiton_tax_rate').val();
      rate_cumlative = $('#rate_cumlative').val();
      registrationtax_transfer = $('#registrationtax_transfer').val();
      registrationtax_mortgage = $('#registrationtax_mortgage').val();
      acquisitiontax_land = $('#acquisitiontax_land').val();
      acquisitiontax_building = $('#acquisitiontax_building').val();
      brokerage_fee_i = $('#brokerage_fee_i').val();
      legal_fee = $('#legal_fee').val();
      bank_fee = $('#bank_fee').val();
      stamptax_transfer = $('#Stamptax_transfer').val();
      stamptax_loan = $('#stamptax_loan').val();
      other_fee = $('#other_fee').val();
      initial_cost = $('#initial_cost').val();
      initial_totalcost = $('#initial_totalcost').val();
      amount_propertytax_land = $('#Amount_propertytax_land').val();
      amount_propertytax_building = $('#amount_propertytax_building').val();
      insurance_fire = $('#insurance_fire').val();
      insurance_earthquake = $('#insurance_earthquake').val();
      opex_rental_management_amount = $('#opex_rental_management_amount').val();
      opex_building_management_amount = $('#opex_building_management_amount').val();
      opex_facility = $('#opex_facility').val();
      opex_water = $('#opex_water').val();
      opex_recruitmentcost = $('#opex_recruitmentcost').val();
      opex_recoverycost = $('#Opex_recoverycost').val();
      opex_other = $('#opex_other').val();
      opex_sum = $('#Opex_sum').val();
      opex_total_rate = $('#Opex_total_rate').val();
      valuation_inheritance_building = $('#valuation_inheritance_building').val();
      special_area_amount = $('#special_area_amount').val();
      valuation_inheritance_land = $('#valuation_inheritance_land').val();
      valuation_inheritance_property = $('#valuation_inheritance_property').val();
      valuation_inheritance_compression = $('#valuation_inheritance_compression').val();
      after_souzokuzei = $('#after_souzokuzei').val();
      auto_valuation_propertytax_land = $('#auto_valuation_propertytax_land').prop('checked');
      auto_valuation_propertytax_building = $('#auto_valuation_propertytax_building').prop('checked');
      auto_price_land = $('.auto_price_land').prop('checked');
      auto_insurance_amount = $('#auto_insurance_amount').prop('checked');
      kpc = $('#kpc').val();
      return;
    }

    function result() {
      $('.result_price_property').val(price_property.toFixed(0));
      $('.result_initial_cost').val(initial_cost.toFixed(0));
      $('.result_initial_totalcost').val(initial_totalcost.toFixed(0));
      $('.result_loan_amount').val(loan_amount.toFixed(0));
      $('.result_equity').val(equity.toFixed(0));
      $('.result_gpi').val(gpi[0].toFixed(0));
      $('.result_surplus').val((gpi[0] * 100 / price_property).toFixed(2));
      $('.result_initial_rate_vacancy').val(initial_rate_vacancy.toFixed(2));
      $('.result_egi').val(egi[0].toFixed(0));
      $('.result_opex').val(opex[0].toFixed(0));
      $('.result_noi').val(noi[0].toFixed(0));
      $('.result_ads').val(ads[0].toFixed(0));
      $('.result_btcf').val(cf[0].toFixed(0));
      $('.result_amount_tax').val(amount_tax[0].toFixed(0));
      $('.result_atcf').val(atcf[0].toFixed(0));
      $('.result_caprate').val((noi[0] / price_property * 100).toFixed(2));
      $('.result_fcr').val((noi[0] / initial_totalcost * 100).toFixed(2));
      $('.result_kpc').val(Kpc[0].toFixed(2));
      $('.result_ccr').val(BTCCR[0].toFixed(2));
      $('.result_dcr').val((noi[0] / ads[0]).toFixed(2));



    }

    function DATAUPDATE() {
      //AUTO_valuation_propetytax();
      //AUTO_amount_propertytax_land();
      //AUTO_amount_propertytax_building();
      //AUTO_BROKERAGE_FEE();
      PROPORTIONAL_CALCULATE();
      //INSURANCE();
      stamptax();
      INHERITANCE();
      BANK_CALC();
      INITIAL_COST_CAL();
      //OPEX_ItoD();
      SHEET_DRAW();
      //フォームからデータ読み込み
      analysis_start_year = parseFloat($('#analysis_start_year').val());
      analysis_period = parseFloat($('#analysis_period').val());
      initial_year = parseFloat($('#initial_year').val());
      initial_ownerage = parseFloat($('#initial_ownerage').val());
      //initial_years_since_purchase=parseFloat($('#initial_years_since_purchase').val());
      initial_years_since_construction = parseFloat($('#initial_years_since_construction').val());
      //initial_totalcost=parseFloat(($('#price_property').val())+parseFloat($('#cost_purchase').val()*($('#cost_purchase').val()/100)));
      gpi = [];
      gpi[0] = parseFloat($('#gpi').val());
      initial_rate_vacancy = $('#initial_rate_vacancy').val() / 100;
      rate_vacancy = []
      egi = []
      //opex_rental_management[0]=0.07;//EGIに掛ける
      //opex_building_management=7000;//一部屋あたり
      //opex_tax=10000;//固定資産税別途計算式作成
      //opex_water_electric[0]=1000;
      //opex_insurance_earthquake=1000;
      //opex_insurance_fire=1000;
      //opex_rate=parseFloat($('#opex_rate').val());
      opex = [];
      noi = [];
      loan_amount = parseFloat($('#loan_amount').val());
      loan_period = parseFloat($('#loan_period').val() * 12);
      loan_rate = parseFloat($('#loan_rate').val() / 12 / 100);
      cf = [];
      depre_price = parseFloat($('#depre_price').val());
      depre_period = construction_table[parseFloat($('#construction').val())][0];
      ////console.log("period="+depre_period);
      depre_unamo = depre_price;//※既存物件を入力する場合は訂正する必要あり
      depre_current = [];
      depre_remain = [];
      depre_total = [];
      taxable = [];
      rate_tax = parseFloat($('#rate_income_tax').val() / 100);
      amount_tax = [];
      atcf = [];
      slice_year = []
      //rate_purchase=parseFloat($('#rate_purchase').val());
      rate_income_tax = [parseFloat($('#rate_income_tax').val())];
      rate_transfer_tax = [];//[parseFloat($('#rate_transfer_tax').val()/100)];
      rate_pluscap = [parseFloat($('#rate_pluscap').val())];
      price_sale = [parseFloat($('#price_property'))];
      rate_sale = parseFloat($('#rate_sale').val());
      cum_atcf = [0];
      sell_bftx = [0];
      sell_aftx = [0];
      PorC = parseFloat($('#PorC').val());
      equity = parseFloat(initial_totalcost - loan_amount);
      $('#equity').val(equity.toFixed(2));
      tax_transfer = [0];
      discount_rate = parseFloat($('#discount_rate').val() / 100);
      IRR = [];
      NPV = [];
      NPV_INHERITANCE = [];
      Kpc = [];
      rate_s = [];
      caprate = [];
      DeCR = [];
      BTCCR = [];
      ATCCR = [];
      FaaCR = [];

      opex_rate = parseFloat($('#Opex_total_rate').val()) / 100;
      //legal_building_period=construction[parseFloat($('#construction').val())][0];
      bank_building_period = depre_period - parseFloat($('#initial_years_since_construction').val());
      if (bank_building_period <= 0) bank_building_period = 0;
      ////console.log("bankperiod="+bank_building_period+"building_period="+depre_period);



      //西暦の設定
      var year = Array.from(new Array(100)).map((v, i) => i + parseFloat($('#initial_year').val()));
      //購入経過年数の設定
      var years_since_purchase = Array.from(new Array(100)).map((v, i) => i)
      //オーナーの年齢の設定
      var age_owner = Array.from(new Array(100)).map((v, i) => i + parseFloat($('#initial_ownerage').val()));
      //購入経過年数の設定
      var years_since_construction = Array.from(new Array(100)).map((v, i) => i + initial_years_since_construction)
      //家賃下落率の設定
      var rate_falling_rent = [0, 0, 0, 0, 0.017, 0.017, 0.017, 0.017, 0.017, 0.017, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.006, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.0010, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001];
      for (var i = 0; i < 1; i++) { rate_falling_rent[i] = parseFloat($('#rate_rent_decline1').val() / 100) };
      for (var i = 1; i < 6; i++) { rate_falling_rent[i] = parseFloat($('#rate_rent_decline2').val() / 100) };
      for (var i = 6; i < 11; i++) { rate_falling_rent[i] = parseFloat($('#rate_rent_decline3').val() / 100) };
      for (var i = 11; i < 21; i++) { rate_falling_rent[i] = parseFloat($('#rate_rent_decline4').val() / 100) };
      for (var i = 21; i < 100; i++) { rate_falling_rent[i] = parseFloat($('#rate_rent_decline5').val() / 100) };
      //console.log("rate_falling_rent=" + rate_falling_rent);
      //GPIの計算←毎年家賃が下落していく
      for (var i = 0; i < 101; i++) {
        var tmp_rate_falling_rent = rate_falling_rent[parseInt(i + initial_years_since_construction)]
        gpi.push(parseFloat(gpi[i] * (1 - tmp_rate_falling_rent)));
        //console.log("gpi=" + gpi[i] + "initial_years_since_construction=" + parseInt(initial_years_since_construction + i) + "fallingrate=" + rate_falling_rent[i + initial_years_since_construction] + "tmpfre=" + tmp_rate_falling_rent);
      }

      //空室率の設定
      for (var i = 0; i < 101; i++) {
        rate_vacancy.push(parseFloat($('#initial_rate_vacancy').val() / 100));
      }
      //EGIの計算←GPIから空室損を引く
      for (var i = 0; i < 101; i++) {
        egi.push(parseFloat(gpi[i] * (1 - rate_vacancy[i])));
      }
      //OPEXの計算
      //opex[0]=parseFloat(egi[0]*opex_rental_management+opex_building_management+opex_insurance_fire+opex_insurance_earthquake+opex_electric+opex_water+opex_tax);
      for (var i = 0; i < 101; i++) {
        opex.push(egi[i] * opex_rate);
        ////console.log("rate_opex"+parseFloat($('#rate_opex')))
      }
      //NOIの計算←EGIからOPEXを引く
      for (var i = 0; i < 101; i++) {
        noi.push(parseFloat(egi[i] - opex[i]));
      };
      //ローン計算（元本・利息・残債の配列を作成）
      LOAN_TABLE(parseFloat($('#loan_rate').val() / 100 / 12), parseFloat($('#loan_period').val() * 12), parseFloat($('#loan_amount').val()));
      //BTCFの計算
      for (var i = 0; i < 101; i++) {
        cf.push(parseFloat(noi[i] - loan_interest_year[i] - loan_principal_year[i]));
      };
      //減価償却の計算
      DEPRECIATION(depre_price, depre_unamo, depre_period, initial_years_since_construction)
      //課税対象の計算
      for (var i = 0; i < 101; i++) {
        taxable[i] = parseFloat(cf[i] + loan_principal_year[i] - depre_current[i]);
      };
      taxable[0] = taxable[0] - (parseFloat($('#initial_cost').val()) - parseFloat($('#brokerage_fee').val()));//一年目の経費に仲介手数料以外の諸経費加算
      //累積償却額
      for (var i = 0; i < 101; i++) {
        depre_total.push(parseFloat(depre_total[i] + depre_current[i]));
        //console.log("depre_total=" + depre_total[i])
      };

      //所得税率の設定
      for (var i = 0; i < 101; i++) {
        rate_income_tax.push(parseFloat(rate_income_tax[i]));
      };
      //税額の計算
      for (var i = 0; i < 101; i++) {
        amount_tax.push(parseFloat(taxable[i] * rate_income_tax[i]) / 100);
      };
      //ATCFの計算
      for (var i = 0; i < 101; i++) {
        atcf.push(parseFloat(cf[i] - amount_tax[i]));
      };
      //累計ATCF
      for (var i = 0; i < 101; i++) {
        cum_atcf.push(parseFloat(cum_atcf[i] = cum_atcf[i] + atcf[i]));
      };
      //売却時キャップレートの設定
      initial_totalcost = parseFloat($('#initial_totalcost').val())
      var initial_cap = noi[0] / parseFloat($('#price_property').val());//当初のキャップレート計算
      rate_pluscap = parseFloat($('#rate_pluscap').val()) / 100;
      //console.log("noi[0]" + noi[0] + "rate_pluscap=" + rate_pluscap + "initialcap" + initial_cap)
      for (var i = 0; i < 101; i++) {
        rate_caprate[i] = initial_cap + rate_pluscap;
      };
      rate_caprate[0] = initial_cap;//もう一度もとに戻す
      //売却価格の査定
      price_sale[0] = ($('#price_property').val());
      for (var i = 0; i < 101; i++) {
        price_sale[i] = (parseFloat(price_sale[i] = noi[i + 1] / ((rate_caprate[i]))));
        //console.log("caprate=" + rate_caprate[i] + "price_sale=" + price_sale[i] + "noi=" + noi[i + 1]);
      };
      price_sale[0] = parseFloat($('#price_property').val());
      //売却金額ーローン残債
      for (var i = 0; i < 101; i++) {
        sell_bftx.push(parseFloat(sell_bftx[i] = price_sale[i] * (1 - (parseFloat(rate_sale) / 100)) - loan_pv_year[i]));
        ////console.log("sell_bftx="+sell_bftx[i]+"rate_sale="+rate_sale+"loan_amount="+loan_pv_year[i]);
      };
      //譲渡税レートの設定
      if (PorC > 0) {
        for (var i = 0; i < 6; i++) {
          rate_transfer_tax.push(0.3963);
          ////console.log("P#C "+$('#PorC').val()+"PorC "+PorC+" rate "+rate_transfer_tax[i]);
        }
        for (var i = 6; i < 101; i++) {
          rate_transfer_tax.push(0.20315);
          //console.log("P l" + rate_transfer_tax[i]);
        }
      }
      else {
        for (var i = 0; i < 101; i++) {
          rate_transfer_tax.push(rate_income_tax[i] / 100);
          //console.log("C" + rate_transfer_tax[i]);
        }
      }
      //譲渡税の計算
      for (var i = 0; i < 101; i++) {
        var tmp_costedsale = (price_sale[i]) * (1 - (parseFloat(rate_sale) / 100));
        fortaxsale[i] = tmp_costedsale - price_property + depre_total[i] - brokerage_fee_land;
        tax_transfer[i] = fortaxsale[i] * rate_transfer_tax[i];
        if (tax_transfer[i] < 0) { tax_transfer[i] = 0 };
        ////console.log("price_sale="+price_sale[i]+"rate_sale="+rate_sale+"initial_totalcost="+initial_totalcost+"depre_total="+depre_total[i]+"rate_transger_Tax="+rate_transfer_tax[i]+"brokerage_fee_land"+brokerage_fee_land+"tax_transfer"+tax_transfer[i]+"tmp_costedsale"+tmp_costedsale+"tmp_fortaxsale"+tmp_fortaxsale);
      };
      //税引後売却手残額
      for (var i = 0; i < 101; i++) {
        if (tax_transfer[i] <= 0) {
          sell_aftx.push(sell_aftx[i] = sell_bftx[i])
        }
        else {
          sell_aftx.push(parseFloat(sell_aftx[i] = (sell_bftx[i] - tax_transfer[i])));
        }
      };
      //総利益の計算（ATCF累積+税引後売却手残金額）
      for (var i = 0; i < 101; i++) {
        cum_profit.push(parseFloat(cum_profit[i] = cum_atcf[i] + sell_aftx[i])) - equity;
      };

      //相続税の計算
      //計算のためにエクイティを差引き
      shisan_cash[0] = parseFloat($('#shisan_cash').val()) - equity;
      shisan_realestate[0] = parseFloat($('#shisan').val()) - parseFloat($('#shisan_cash').val())
      //console.log("equity" + equity + "shisan_cash" + shisan_cash[0] + "shisan_realestate" + shisan_realestate[0]);
      //不動産の計算
      for (var i = 1; i < 100; i++) {
        valuation_inheritance_land.push(parseFloat(valuation_inheritance_land[i] = valuation_inheritance_land[i - 1]));
        valuation_inheritance_building.push(parseFloat(valuation_inheritance_building[i] = valuation_inheritance_building[0] * aging_rate[construction_table[parseFloat($('#construction').val())][5]][i]));
        valuation_inheritance_property[i] = valuation_inheritance_land[i] + valuation_inheritance_building[i];
        shisan_cash[i] = shisan_cash[i - 1] + atcf[i - 1];
        shisan_realestate[i] = shisan_realestate[i - 1];
        valuation_inheritance_total[i] = shisan_realestate[i] + shisan_cash[i] + valuation_inheritance_property[i] - loan_pv_year[i];//初期費用もマイナスする処理を残している
        souzokuzei = Souzokuzeikeisan(valuation_inheritance_total[i]);
        ////console.log("valuation_inheritance_total="+valuation_inheritance_total+"equity="+equity+"souzoku="+souzokuzei);
        inheritance_amount.push(inheritance_amount[i] = souzokuzei);
        inheritance_compression.push(inheritance_compression[i] = inheritance_amount[0] - souzokuzei);
        inheritance_togo[i] = shisan_cash[i] - inheritance_amount[i];
      };
      //グラフのために０年を初期値の戻す
      shisan_cash[0] = parseFloat($('#shisan_cash').val());
      valuation_inheritance_total[0] = parseFloat($('#shisan').val());
      inheritance_togo[0] = shisan_cash[0] - inheritance_amount[0];
      valuation_inheritance_property[0] = valuation_inheritance_land[0] + valuation_inheritance_building[0];


      /*//相続税評価・相続税額の計算
      for (  var i = 1;  i < 100;  i++  ) {
        valuation_inheritance_land.push(parseFloat(valuation_inheritance_land[i]=valuation_inheritance_land[i-1]));
        valuation_inheritance_building.push(parseFloat(valuation_inheritance_building[i]=valuation_inheritance_building[0]*aging_rate[construction_table[parseFloat($('#construction').val())][5]][i]));
        valuation_inheritance_property.push(valuation_inheritance_property[i]=valuation_inheritance_land[i]+valuation_inheritance_building[i]);
        var valuation_inheritance_total=shisan_cash[i]+valuation_inheritance_property[i]-loan_pv_year[i];//初期費用もマイナスする処理を残している
        var souzokuzei=Souzokuzeikeisan(valuation_inheritance_total);
        ////console.log("valuation_inheritance_total="+valuation_inheritance_total+"equity="+equity+"souzoku="+souzokuzei);
        inheritance_amount.push(inheritance_amount[i]=souzokuzei);
        inheritance_compression.push(inheritance_compression[i]=inheritance_amount[0]-souzokuzei);
      };
      valuation_inheritance_property[0]=shisan_cash[0]+valuation_inheritance_building[0]+valuation_inheritance_land[0];
      //相続税圧縮効果＋総利益の計算（ATCF累積+税引後売却手残金額＋相続税圧縮効果）
      for (  var i = 0;  i < 101;  i++  ) {
        inheritance_cum_profit.push(parseFloat(inheritance_cum_profit[i]=cum_atcf[i]+sell_aftx[i]))+inheritance_compression[i]-equity;
      };
      */
      //銀行積算評価の計算
      for (var i = 1; i < 100; i++) {
        bank_land.push(parseFloat(bank_land[i] = bank_land[i - 1]));
        if (depre_period <= initial_years_since_construction + i) { var tmp = 0 }
        else { var tmp = depre_period - initial_years_since_construction - i };

        bank_building[i] = bank_building[0] * tmp / (bank_building_period + 0.0001);
        bank_total[i] = bank_land[i] + bank_building[i];
        //console.log("銀行建物評価tmp=" + tmp + "銀行建物評価=" + bank_building[i] + "bank_building_period " + bank_building_period + "bankbuilding[0]" + bank_building[0]);
      };
      bank_total[0] = bank_building[0] + bank_land[0];



      //補助線（zeroline,equity,totalcost)
      for (var i = 0; i < 101; i++) {
        graph_zeroline[i] = 0;
        graph_equity[i] = equity;
        graph_totalcost[i] = price_property;
      };


      //分析期間の指定
      i = _.indexOf(year, analysis_start_year);
      if (i + analysis_period > 100) { i = 100 - analysis_period };
      //slice_rate_falling_rent=_.slice(rate_falling_rent,i,i+analysis_period);
      slice_year = _.slice(year, i, i + analysis_period);
      slice_age_owner = _.slice(age_owner, i, i + analysis_period);
      slice_years_since_purchase = _.slice(years_since_purchase, i, i + analysis_period);
      slice_years_since_construction = _.slice(years_since_construction, i, i + analysis_period);
      slice_gpi = _.slice(gpi, i, i + analysis_period);
      slice_egi = _.slice(egi, i, i + analysis_period);
      slice_opex = _.slice(opex, i, i + analysis_period);
      slice_noi = _.slice(noi, i, i + analysis_period);
      slice_ads = _.slice(ads, i, i + analysis_period);
      slice_cf = _.slice(cf, i, i + analysis_period);
      slice_loan_principal_year = _.slice(loan_principal_year, i, i + analysis_period);
      slice_depre_current = _.slice(depre_current, i, i + analysis_period);
      slice_taxable = _.slice(taxable, i, i + analysis_period);
      slice_amount_tax = _.slice(amount_tax, i, i + analysis_period);
      slice_atcf = _.slice(atcf, i, i + analysis_period);
      slice_cum_atcf = _.slice(cum_atcf, i, i + analysis_period);
      slice_price_sale = _.slice(price_sale, i, i + analysis_period);
      slice_cum_profit = _.slice(cum_profit, i, i + analysis_period);
      slice_inheritance_cum_profit = _.slice(inheritance_cum_profit, i, i + analysis_period)
      slice_loan_pv_year = _.slice(loan_pv_year, i, i + analysis_period);
      slice_sell_aftx = _.slice(sell_aftx, i, i + analysis_period);
      slice_sell_bftx = _.slice(sell_bftx, i, i + analysis_period);
      slice_tax_transfer = _.slice(tax_transfer, i, i + analysis_period);
      slice_valuation_inheritance_building = _.slice(valuation_inheritance_building, i, i + analysis_period);
      slice_valuation_inheritance_land = _.slice(valuation_inheritance_land, i, i + analysis_period);
      slice_valuation_inheritance_property = _.slice(valuation_inheritance_property, i, i + analysis_period);
      slice_inheritance_amount = _.slice(inheritance_amount, i, i + analysis_period);
      slice_inheritance_compression = _.slice(inheritance_compression, i, i + analysis_period);
      slice_bank_building = _.slice(bank_building, i, i + analysis_period);
      slice_bank_land = _.slice(bank_land, i, i + analysis_period);
      slice_bank_total = _.slice(bank_total, i, i + analysis_period);
      slice_depre_total = _.slice(depre_total, i, i + analysis_period);
      slice_shisan_cash = _.slice(shisan_cash, i, i + analysis_period);
      slice_valuation_inheritance_total = _.slice(valuation_inheritance_total, i, i + analysis_period);
      slice_inheritance_togo = _.slice(inheritance_togo, i, i + analysis_period);
      slice_fortaxsale = _.slice(fortaxsale, i, i + analysis_period);

      ////console.log(slice_tax_transfer.length);

      //投資分析
      //console.log("slicenoi=" + slice_noi[0] + "initial_totalcost=" + initial_totalcost);
      FaCR[0] = (slice_noi[0] / parseFloat(initial_totalcost));

      //Kp=parseFloat(slice_ads[0]/parseFloat($('#loan_amount').val()));
      //CCR=parseFloat((slice_noi[0]-slice_ads[0])/equity);
      //DCR=parseFloat(slice_noi[0]/slice_ads[0]);
      //NPV・IRRの計算
      for (var i = 0; i <= slice_cum_profit.length; i++) {
        FLOW = slice_atcf.slice(0, i);
        FLOW.unshift(-equity);
        //FLOW[0]=-equity;
        FLOW[i + 1] = slice_atcf[i] + slice_sell_aftx[i];
        ////console.log("FLOW="+ FLOW);
        NPV.push(NPV[i] = XNPV(discount_rate, i, FLOW));
        //var tmp=parseFloat(XIRR(FLOW,i)*100);
        IRR.push(IRR[i] = (XIRR(FLOW, i) * 100));
      }
      //相続税圧縮効果を含むNPV・IRRの計算
      for (var i = 0; i <= slice_cum_profit.length; i++) {
        FLOW = slice_atcf.slice(0, i);
        FLOW.unshift(-equity);
        //FLOW[0]=-equity;
        FLOW[i + 1] = slice_atcf[i] + slice_sell_aftx[i] + slice_inheritance_compression[i];
        ////console.log("FLOW="+ FLOW);
        NPV_INHERITANCE[i] = XNPV(discount_rate, i, FLOW);
        //var tmp=parseFloat(XIRR(FLOW,i)*100);
        IRR_INHERITANCE[i] = (XIRR(FLOW, i) * 100);
      };
      NPV_INHERITANCE[0] = 0;//エラー除去
      var tmp_inheritance_compression = parseFloat($('#amount_inheritance_compression').val())
      NPV_INHERITANCE[0] = (parseFloat((NPV[0]) + tmp_inheritance_compression).toFixed(0));//エラー回避
      //表面利回・K％・caprate・DCRの計算
      for (var i = 0; i <= slice_cum_profit.length - 2; i++) {
        //Kpc[i]=(slice_ads[i]/slice_loan_pv_year[i])*100;
        //console.log("ads=" + slice_ads[i] + "pv=" + slice_loan_pv_year[i]);
        rate_s[i] = (slice_gpi[i] / slice_price_sale[i]) * 100;
        caprate[i] = (slice_noi[i + 1] / slice_price_sale[i]) * 100;
        //DeCR[i]=(slice_noi[i]/slice_ads[i]);
        BTCCR[i] = (slice_cf[i] / equity) * 100;
        ATCCR[i] = (slice_atcf[i] / equity) * 100;
        FaCR[i] = (slice_noi[i] / initial_totalcost) * 100;

        ////console.log("Kpc="+Kpc[i]+"rate_s="+rate_s[i]);
      };

      for (var i = 0; i <= parseInt($('#loan_period').val() - 2); i++) {
        Kpc[i] = (slice_ads[i] / slice_loan_pv_year[i]) * 100;
        DeCR[i] = (slice_noi[i] / slice_ads[i]);
        ////console.log("Kpc="+Kpc[i]+"rate_s="+rate_s[i]);
      };
      for (var i = parseInt($('#loan_period').val() - 2); i <= 100; i++) {
        Kpc[i] = 0;
        DeCR[i] = 0;
        ////console.log("Kpc="+Kpc[i]+"rate_s="+rate_s[i]);
      };


      Kpc[0] = (slice_ads[0]) / parseFloat($('#loan_amount').val()) * 100;//初年度のK%だけは当初のローン残高で計算


      /*
      NPV[0]=XNPV(0.5,values);
      IRR[0]=XIRR(values);
       //console.log("FCR="+FCR+"K%="+Kp+"CCR="+CCR+"DCR="+DCR+"IRR="+IRR[0]+"NPV="+NPV[0]);
      */
      //return;};//DATAUPDATE
      return
    };

    function GRAPH_DRAW() {

      //グラフ・セルデータの作成
      cfdata = [
        slice_age_owner,
        slice_years_since_purchase,
        slice_years_since_construction,
        slice_gpi,
        slice_egi,
        slice_opex,
        slice_noi,
        slice_ads,
        slice_cf,
        slice_loan_principal_year,
        slice_depre_current,
        slice_taxable,
        slice_amount_tax,
        slice_atcf,
        slice_cum_atcf,
        slice_price_sale,
        slice_loan_pv_year,
        slice_sell_bftx,
        slice_fortaxsale,
        slice_tax_transfer,
        slice_sell_aftx,
        slice_cum_profit,
        NPV,
        slice_bank_land,
        slice_bank_building,
        slice_bank_total,
        slice_valuation_inheritance_land,
        slice_valuation_inheritance_building,
        slice_valuation_inheritance_property,
        slice_inheritance_amount,
        slice_inheritance_compression,
        NPV_INHERITANCE,
        slice_depre_total,
        slice_shisan_cash,
        slice_valuation_inheritance_total,
        slice_inheritance_togo,




      ];
      analysisdata = [
        rate_s,
        caprate,
        FaCR,
        Kpc,
        BTCCR,
        ATCCR,
        IRR,
        DeCR,
        IRR_INHERITANCE

      ];


      //グラフ描画
      var complexChartOption = {
        responsive: true,
        scales: {
          yAxes: [{
            id: "mini",   // Y軸のID
            type: "line",   // linear固定 
            position: "left", // どちら側に表示される軸か？
          }, {
            id: "large",
            type: "line",
            position: "right",
          }],
        }
      };



      if (myBarChart) {
        myBarChart.destroy()
      };
      var ctx = document.getElementById("cfChart");
      window.myBarChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: slice_year,
          datasets: [

            {
              label: 'GPI',
              data: slice_gpi,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[0],
              borderColor: '#FFD180'
            }, {
              label: 'EGI',
              data: slice_egi,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[1],
              borderColor: '#FFAB40'
            }, {
              label: 'OPEX',
              data: slice_opex,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[2],
              borderColor: '#283593'

            }, {
              label: 'NOI',
              data: slice_noi,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[3],
              borderColor: '#FF9100'
            }, {
              label: 'ADS',
              data: slice_ads,
              type: 'line',
              fill: false,
              lineTension: 0,
              radius: 0,
              hidden: legendShow[4],
              borderColor: "#D1C4E9",
            }, {
              label: 'CF',
              data: slice_cf,
              type: 'bar',
              fill: false,
              radius: 0,
              hidden: legendShow[5],
              borderColor: '#FF9100',
              backgroundColor: '#FF9100'
            }, {
              label: 'ローン元金',
              data: slice_loan_principal_year,
              type: 'line',
              fill: false,
              lineTension: 0,
              radius: 0,
              hidden: legendShow[6],
              borderColor: "#7E57C2",
            }, {
              label: '減価償却費',
              data: slice_depre_current,
              type: 'line',
              lineTension: 0,
              fill: false,
              radius: 0,
              hidden: legendShow[7],
              borderColor: '#CDDC39'
            }, {
              label: '課税対象額',
              data: slice_taxable,
              type: 'line',
              fill: true,
              radius: 0,
              hidden: legendShow[8],
              borderColor: '#03A9F4',
              backgroundColor: '#E1F5FE'
            }, {
              label: '税額',
              data: slice_amount_tax,
              type: 'line',
              fill: true,
              radius: 0,
              hidden: legendShow[9],
              borderColor: '#01579B',
              backgroundColor: '#E8EAF6'
            }, {
              label: 'ATCF',
              data: slice_atcf,
              borderColor: 'black',
              type: 'bar',
              fill: false,
              radius: 0,
              hidden: legendShow[10],
              borderColor: '#000000',
              backgroundColor: '#FF6D00'
            }, {
              label: '累積ATCF',
              data: slice_cum_atcf,
              type: 'line',
              fill: true,
              radius: 0,
              hidden: legendShow[11],
              yAxisID: "yright",
              backgroundColor: "#FFE0B2",
              borderColor: '#FF6D00'

            }, {
              label: '売却想定価格',
              data: slice_price_sale,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[12],
              yAxisID: "yright",
              borderColor: '#0091EA'

            }, {
              label: 'ローン残債',
              data: slice_loan_pv_year,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[13],
              yAxisID: "yright",
              borderColor: "#EDE7F6"

            }, {
              label: '減価償却累計',
              data: slice_depre_total,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[14],
              yAxisID: "yright",
              borderColor: "#7CB342"

            }, {
              label: '譲渡税対象',
              data: slice_fortaxsale,
              type: 'line',
              fill: true,
              radius: 0,
              hidden: legendShow[15],
              yAxisID: "yright",
              borderColor: "#EDE7F6",
              backgroundColor: '#80D8FF'

            }, {
              label: '譲渡税',
              data: slice_tax_transfer,
              type: 'bar',
              fill: true,
              radius: 0,
              hidden: legendShow[16],
              yAxisID: "yleft",
              backgroundColor: '#0091EA'
            }, {
              label: '売却時手取金額(税引前）',
              data: slice_sell_bftx,
              type: 'bar',
              fill: true,
              radius: 0,
              hidden: legendShow[17],
              yAxisID: "yright",
              backgroundColor: '#C5E1A5'

            }, {
              label: '売却時手取金額(税引後)',
              data: slice_sell_aftx,
              type: 'bar',
              fill: true,
              radius: 0,
              hidden: legendShow[18],
              yAxisID: "yright",
              backgroundColor: '#8BC34A'

            }, {
              label: 'NPV',
              data: NPV,
              type: 'line',
              fill: true,
              radius: 0,
              hidden: legendShow[19],
              yAxisID: "yright",
              borderColor: '#F57F17',
              backgroundColor: '#FFF9C4'

            }, {
              label: '建物相続税評価額（万円）',
              data: slice_valuation_inheritance_building,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[20],
              yAxisID: "yright",
              borderColor: '#A7FFEB'

            }, {
              label: '土地相続税評価額（万円）',
              data: slice_valuation_inheritance_land,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[21],
              yAxisID: "yright",
              borderColor: '#1DE9B6'

            }, {
              label: '相続税評価額合計（万円）',
              data: slice_valuation_inheritance_property,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[22],
              yAxisID: "yright",
              borderColor: '#1DE9B6'

            }, {
              label: '建物積算評価額（万円）',
              data: slice_bank_building,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[23],
              yAxisID: "yright",
              borderColor: '#B388FF'

            }, {
              label: '土地積算評価額（万円）',
              data: slice_bank_land,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[24],
              yAxisID: "yright",
              borderColor: '#7C4DFF'

            }, {
              label: '積算評価額合計（万円）',
              data: slice_bank_total,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[25],
              yAxisID: "yright",
              borderColor: "#311B92",

            }, {
              label: 'IRR',
              data: IRR,
              type: 'line',
              fill: true,
              radius: 0,
              hidden: legendShow[26],
              yAxisID: "yleft",
              borderColor: '#90A4AE'

            }, {
              label: '表面利回',
              data: rate_s,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[27],
              yAxisID: "yleft",
              borderColor: '#FFD180'

            }, {
              label: 'Caprate',
              data: caprate,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[28],
              yAxisID: "yleft",
              borderColor: '#FFB74D'

            }, {
              label: 'FCR',
              data: FaCR,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[29],
              yAxisID: "yleft",
              borderColor: '#FF9100'

            }, {
              label: 'K%',
              data: Kpc,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[30],
              yAxisID: "yleft",
              borderColor: "#D1C4E9",

            }, {
              label: 'BTCCR',
              data: BTCCR,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[31],
              yAxisID: "yleft",
              borderColor: '#EF6C00'

            }, {
              label: 'ATCCR',
              data: ATCCR,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[32],
              yAxisID: "yleft",
              borderColor: '#E65100'

            }, {
              label: 'DCR',
              data: DeCR,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[33],
              yAxisID: "yleft",
              borderColor: '#0097A7'

            }, {
              label: '総相続税評価額',
              data: valuation_inheritance_total,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[34],
              yAxisID: "yright",
              borderColor: '#004D40',
              backgroundColor: '#FFFFFF'

            }, {
              label: '相続税額',
              data: inheritance_amount,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[35],
              yAxisID: "yright",
              borderColor: '#00796B',

            }, {
              label: '相続税圧縮額',
              data: inheritance_compression,
              type: 'line',
              fill: true,
              radius: 0,
              hidden: legendShow[36],
              yAxisID: "yright",
              borderColor: '#00796B',
              backgroundColor: '#B2DFDB'


            }, {
              label: '相続勘案NPV',
              data: NPV_INHERITANCE,
              type: 'line',
              fill: true,
              radius: 0,
              hidden: legendShow[37],
              yAxisID: "yright",
              borderColor: '#00796B',
              backgroundColor: '#FFF9C4'
            }, {
              label: '相続勘案IRR',
              data: IRR_INHERITANCE,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[38],
              yAxisID: "yleft",
              borderColor: '#00796B',
              backgroundColor: '#FFF9C4'
            }, {
              label: '現金資産（万円）',
              data: shisan_cash,
              type: 'line',
              fill: false,
              radius: 5,
              hidden: legendShow[39],
              yAxisID: "yright",
              borderColor: '#FF6D00',
              backgroundColor: '#FFE57F',
              order: 0
            }, {
              label: '相続税納税後剰余額',
              data: inheritance_togo,
              type: 'line',
              fill: true,
              radius: 0,
              hidden: legendShow[40],
              yAxisID: "yright",
              borderColor: '#004D40',
              backgroundColor: '#FFAB91'
            }, {
              label: '投下自己資金',
              data: graph_equity,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[41],
              yAxisID: "yright",
              borderColor: '#00E676',
              backgroundColor: '#FFFFFF',
              borderDash: [10, 50]

            }, {
              label: '物件購入価格',
              data: graph_totalcost,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[42],
              yAxisID: "yright",
              borderColor: '#00C853',
              backgroundColor: '#FFFFFF',
              borderDash: [10, 50]

            }, {
              label: 'ゼロラインR',
              data: graph_zeroline,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[43],
              yAxisID: "yright",
              borderColor: '#000000',
              backgroundColor: '#FFF9C4',
              borderDash: [10, 50]

            }, {
              label: 'ゼロラインL',
              data: graph_zeroline,
              type: 'line',
              fill: false,
              radius: 0,
              hidden: legendShow[44],
              yAxisID: "yleft",
              borderColor: '#000000',
              backgroundColor: '#FFF9C4',
              borderDash: [10, 50]

            }
          ]
        },
        options: {
          scales: {
            yAxes: [{
              id: "yleft",
              position: "left",
              gridLines: {
                drawOnChartArea: false,
                zeroLineColor: 'black'
              }
            },

            {
              id: "yright",
              position: "right",
              gridLines: {
                drawOnChartArea: false,
                zeroLineColor: 'black'
              }

            }]
          },
          legend: {
            display: true,
            position: "top",
            legendCallback: function (chart) {
              // Return the HTML string here.

            }

          }
        }

      }
      )
      var complexChartOption = {
        responsive: true,
        scales: {
          yAxes: [{
            id: "mini",   // Y軸のID
            type: "line",   // linear固定 
            position: "left", // どちら側に表示される軸か？
          }, {
            id: "large",
            type: "line",
            position: "right",
          }],
        }
      };
      //return cfdata};//グラフ描画終わり

      //if (analysisChart) {
      //    analysisChart.destroy()};
      /*
      var cty = document.getElementById("analysisChart");
        window.analysisChart = new Chart(cty, {
          type: 'bar',
          data: {
            labels: slice_year,
            datasets: [
      
              {
                label: 'IRR',
                data: IRR,
                type:'line',
                fill:false,
                radius:0,
                hidden:false
              },{
                label: 'Kpc',
                data: Kpc,
                type:'line',
                fill:false,
                radius:0,
                hidden:false
              },{
                label: 'Caprate',
                data: caprate,
                type:'line',
                fill:false,
                radius:0,
                hidden:false
      
              },{
                label: '表面利回',
                data: rate_s,
                type:'line',
                fill:false,
                radius:0,
                hidden:false
              },
            ]
          },
          options:{
            scales:{
              yAxes:[{
                id:"yleft",
                position:"left",
                gridLines:{
                  drawOnChartArea:false,
                  zeroLineColor:'black'
              }},
      
              {
                id:"yright",
                position:"right",
                gridLines:{
                  drawOnChartArea:false,
                  zeroLineColor:'black'
                }
      
              }]
            }
          }
          
      })
      */
      return
    };

    function SHEET_DRAW() {


      //console.log("cfdata" + cfdata)
      //シート描画
      cfsheet = document.getElementById('cfsheet');
      var handsontable_data =
      {
        data: cfdata,
        width: 1920,
        height: 860,
        type: 'numeric',
        format: '000,000',
        rowHeaderWidth: 150,
        manualRowMove: false,
        readonly: true,
        rowHeaders: function (index) {
          return ['オーナーの年齢（歳）', '購入後年数（年）', '築年数（年）', 'GPI（万円）', 'EGI（万円）', '- OPEX（万円）', '= NOI（万円）', '- ADS（万円）', '= BTCF（万円）', '+ ローン元金（万円）', '- 減価償却費（万円）', '= 課税対象額（万円）', '税額（万円）', 'ATCF（万円）', '累積ATCF（万円）', '売却想定価格（万円）', '期末ローン残債（万円）', '税引前売却手取額（万円）', '譲渡税対象（万円）', '譲渡税（万円）', '税引後売却手取額（万円）', '増加資産（万円）', 'NPV（万円）', '土地積算評価（万円）', '建物積算評価（万円）', '積算評価合計（万円）', '土地相続税評価額（万円）', '建物相続税評価額（万円）', '相続税評価額合計（万円）', '相続税額（万円）', '相続税圧縮額（万円）', '相続税圧縮効果勘案NPV（万円）', '累積償却額（万円）', '現金（万円）', '総相続税評価額（万円）', '相続税納税剰余額（万円）'][index];
        },
        colHeaders: function (index) {
          return slice_year[index];
        },

      }

      //メインシート
      var hot = new Handsontable(cfsheet, handsontable_data);////メインシート終わり

      //指標シート
      var handsontable_analysis_data =
      {
        data: analysisdata,
        width: 1920,
        height: 400,
        type: 'numeric',
        format: '0.00',
        rowHeaderWidth: 150,
        rowHeaders: function (index) {
          return ['表面利回', 'Caprate', 'FCR', 'K%', 'CCR(税引前)', 'CCR(税引後', 'IRR', 'DCR', '相続税圧縮効果勘案IRR'][index];
        },
        colHeaders: function (index) {
          return slice_year[index];
        },
      }
      analysis = document.getElementById('analysis');
      var hot = new Handsontable(analysis, handsontable_analysis_data);//指標シート終わり
      return
    };//シート描画終わり
  </script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>
  </script>

  <!-- PDF関連のスクリプト -->
  <script src="https://cdn.jsdelivr.net/npm/jquery-binarytransport@1.0.0/jquery.binarytransport.min.js"></script>
  <script src="./pdf.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.7/dist/html2canvas.min.js"></script>
  <script src="./labelmake.min.js"></script>;